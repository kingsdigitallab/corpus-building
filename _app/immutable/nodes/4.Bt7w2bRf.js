const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/openseadragon.CtDNE41u.js","../chunks/maplibre-gl.BTuv7Yai.js","../chunks/utils.dzgPpf3o.js","../chunks/disclose-version.yxoevJ6J.js","../assets/maplibre-gl.CuCRB34y.css"])))=>i.map(i=>d[i]);
var Yt=Object.defineProperty;var Kt=(i,t,h)=>t in i?Yt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):i[t]=h;var Lt=(i,t,h)=>Kt(i,typeof t!="symbol"?t+"":t,h);import{_ as Xt}from"../chunks/preload-helper.C1FmrZbK.js";import{w as Mt,x as Jt,a as k,e as Ge,t as O,b as C,s as qe,y as Pe,c as oe,z as Qt,d as ft}from"../chunks/disclose-version.yxoevJ6J.js";import{h as $t,k as Et,m as St,j as ea,q as Tt,a7 as ta,aN as aa,aM as na,N as ra,a1 as oa,a0 as ia,p as ye,f as te,e as u,r as s,t as R,s as g,d as pe,aR as da,aS as Rt,aT as j,aU as Be,C as b,g as a,aV as H,v as S,aW as la,aX as At,D as vt,K as sa,n as Pt}from"../chunks/utils.dzgPpf3o.js";import{i as U,p as c,b as jt,a as ca}from"../chunks/props.BxeGn5nG.js";import{s as re,a as mt,c as ua,d as fa,e as We,i as Fe}from"../chunks/attributes.DJj9jQYP.js";import{c as gt,a as Ye,o as qt}from"../chunks/index-client.DkxbLtkQ.js";import{w as Le,r as ct,b as va}from"../chunks/paths.DKzBeAOb.js";import{m as ve,s as ma,t as ga,I as ha}from"../chunks/maplibre-gl.BTuv7Yai.js";import{d as ut,i as _a,m as ya,E as fe,p as pa}from"../chunks/config.xn5Jidz-.js";import{i as ze}from"../chunks/legacy.C6KA_5n4.js";function tt(i,t,h,e,o){var r=i,x="",l;$t(()=>{if(x===(x=t()??"")){Et&&St();return}l!==void 0&&(ia(l),l=void 0),x!==""&&(l=ea(()=>{if(Et){Tt.data;for(var n=St(),y=n;n!==null&&(n.nodeType!==8||n.data!=="");)y=n,n=ta(n);if(n===null)throw aa(),na;Mt(Tt,y),r=ra(n);return}var I=x+"",P=Jt(I);Mt(oa(P),P.lastChild),r.before(P)}))})}var xa=O("<span> </span>"),ba=O("<span> </span>"),ka=O("<a> </a>"),Ca=O("<span> </span>"),wa=O("<a>Zotero</a>"),Oa=O("<a>FAIR</a>"),La=O("<!> <!> <!> <!>",1);function Ma(i,t){ye(t,!0);var h=La(),e=te(h);U(e,()=>t.entry.type==="bulletin"||t.entry.type==="corpus",l=>{var n=xa(),y=u(n);s(n),R(()=>C(y,`${t.entry.n??""} ${(t.entry.author?`${t.entry.author} (${t.entry.date})`:"")??""}`)),k(l,n)},l=>{var n=ba(),y=u(n);s(n),R(()=>C(y,`${t.entry.author??""} (${t.entry.date??""})`)),k(l,n)});var o=g(e,2);U(o,()=>{var l;return typeof t.entry.citedRange=="object"&&((l=t.entry.citedRange)==null?void 0:l.ref)},l=>{var n=ka(),y=u(n,!0);s(n),R(()=>{re(n,"href",t.entry.citedRange.ref.target),C(y,t.entry.citedRange.ref._)}),k(l,n)},l=>{var n=Ge(),y=te(n);U(y,()=>t.entry.citedRange,I=>{var P=Ca(),z=u(P,!0);s(P),R(()=>C(z,t.entry.citedRange)),k(I,P)},null,!0),k(l,n)});var r=g(o,2);U(r,()=>{var l;return(l=t.entry.ptr)==null?void 0:l.target},l=>{var n=wa();R(()=>{var y;return re(n,"href",(y=t.entry.ptr)==null?void 0:y.target)}),k(l,n)});var x=g(r,2);U(x,()=>{var l;return(l=t.entry.ref)==null?void 0:l.target},l=>{var n=Oa();R(()=>re(n,"href",t.entry.ref.target)),k(l,n)}),k(i,h),pe()}const ht=Symbol.for("svelte-maplibre");function Ke(){return da(ht)}function Ea(i){let t=new WeakMap;return h=>{var x;let e=t.get(h.originalEvent);if(e!==void 0)return e;let r=(x=h.target.queryRenderedFeatures(h.point).find(l=>{var n;return(n=i.get(l.layer.id))==null?void 0:n.interactive}))==null?void 0:x.layer.id;return t.set(h.originalEvent,r),r}}function Sa(){let i=new Map;return Rt(ht,{map:Le(null),source:ct(null),layer:ct(null),popupTarget:ct(null),cluster:Le(),loadedImages:Le(new Set),minzoom:Le(0),maxzoom:Le(24),layerEvent:Le(null),layerInfo:i,eventTopMost:Ea(i),markerClickManager:new Da})}function It(i){return{subscribe:i.subscribe}}function Ta({key:i,setPopupTarget:t=!1,setCluster:h=!1,setMouseEvent:e=!1}){let o=Ke(),r=Le(null),x=It(r),l={...o,[i]:It(r)};if(t&&(l.popupTarget=x),e){let n=Le(null);l.layerEvent=n,o.layerEvent=n}return h&&(l.cluster=Le()),Rt(ht,l),{...o,self:r}}function Pa(){return Ta({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Ia(i){return"layerType"in i&&i.layerType==="deckgl"}class Da{constructor(){Lt(this,"_handlers",new Set)}add(t){this._handlers.add(t)}remove(t){this._handlers.delete(t)}handleClick(t){for(const h of this._handlers)h(t)}}var Bt=Ra;function Ra(i){var t,h,e;if(i){if(Array.isArray(i)){for(t=[],h=i.length,e=0;e<h;e++){var o=i[e];o!=null&&t.push(o)}return t}if(typeof i=="object"){t={};var r=Object.keys(i);for(h=r.length,e=0;e<h;e++){var x=r[e],l=i[x];l!=null&&(t[x]=l)}return t}}}function Aa(i,t){ye(t,!1);const h=qe(),e=()=>oe(X,"$marker",h),o=()=>oe(T,"$map",h);let r=c(t,"marker",12,void 0),x=c(t,"lngLat",12),l=c(t,"class",8,void 0),n=c(t,"draggable",8,!1),y=c(t,"feature",8,null),I=c(t,"offset",8,void 0),P=c(t,"rotation",8,0),z=c(t,"opacity",8,1);const W=gt(),{map:T,layerEvent:F,self:X}=Pa(),ie=()=>G("dragstart"),xe=()=>{be(),G("drag")},V=()=>{be(),G("dragend")};Pe(X,new ve.Marker(Bt({draggable:n(),rotation:P(),className:l(),offset:I(),opacity:z().toString()})).setLngLat(x()).addTo(o())),r(e()),n()&&(e().on("dragstart",ie),e().on("drag",xe),e().on("dragend",V)),Ye(()=>{var L;r(void 0),(L=e())==null||L.remove()});function be(){var $;let L=($=e())==null?void 0:$.getLngLat();L&&(Array.isArray(x())?x([L.lng,L.lat]):x()&&"lon"in x()?x({lon:L.lng,lat:L.lat}):x(L))}function G(L){var Me,se;let $=(Me=e())==null?void 0:Me.getLngLat();if(!$)return;const me=[$.lng,$.lat];let le={map:o(),marker:e(),lngLat:me,features:[{type:"Feature",properties:((se=y())==null?void 0:se.properties)??{},geometry:{type:"Point",coordinates:me}}]};Pe(F,{...le,layerType:"marker",type:L}),W(L,le)}j(()=>(e(),b(x())),()=>{var L;(L=e())==null||L.setLngLat(x())}),j(()=>(e(),b(I())),()=>{var L;(L=e())==null||L.setOffset(I()??[0,0])}),j(()=>(e(),b(P())),()=>{var L;(L=e())==null||L.setRotation(P())}),j(()=>(e(),b(z())),()=>{var L;(L=e())==null||L.setOpacity(z().toString())}),Be(),ze();var de=Ge(),q=te(de);mt(q,t,"default",{get marker(){return e()}},null),k(i,de),pe()}function ja(i,t){ye(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ke();let r=c(t,"position",8,"top-left"),x=c(t,"container",8,void 0),l=H(null);Ye(()=>{var n;(n=e())!=null&&n.loaded()&&a(l)&&e().removeControl(a(l))}),j(()=>(e(),a(l),b(x()),b(r())),()=>{if(e()&&!a(l)){let n;typeof x()=="string"?n=document.querySelector(x())??void 0:n=x(),S(l,new ve.FullscreenControl({container:n})),e().addControl(a(l),r())}}),Be(),ze(),pe()}function qa(i,t){ye(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ke();let r=c(t,"position",8,"top-left"),x=c(t,"positionOptions",8,void 0),l=c(t,"fitBoundsOptions",8,void 0),n=c(t,"trackUserLocation",8,!1),y=c(t,"showAccuracyCircle",8,!0),I=c(t,"showUserLocation",8,!0),P=c(t,"control",12,null);Ye(()=>{var z;(z=e())!=null&&z.loaded()&&P()&&e().removeControl(P())}),j(()=>(e(),b(P()),b(x()),b(l()),b(n()),b(y()),b(I()),b(r())),()=>{e()&&!P()&&(P(new ve.GeolocateControl({positionOptions:x(),fitBoundsOptions:l(),trackUserLocation:n(),showAccuracyCircle:y(),showUserLocation:I()})),e().addControl(P(),r()))}),Be(),ze(),pe()}function Ba(i){let t=i.getCenter(),h=Math.round(i.getZoom()*100)/100,e=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,e),r=Math.round(t.lat*o)/o,x=Math.round(t.lng*o)/o,l=`${h}/${r}/${x}`,n=i.getBearing(),y=i.getPitch();return(n||y)&&(l+=`/${Math.round(n*10)/10}`),y&&(l+=`/${Math.round(y)}`),`#${l}`}function za(i){return i.replace("#","").split("/").map(parseFloat)}var Ve=_t;function _t(i,t){return i===t||i!==i&&t!==t?!0:typeof i!=typeof t||{}.toString.call(i)!={}.toString.call(t)||i!==Object(i)||!i?!1:Array.isArray(i)?Dt(i,t):{}.toString.call(i)=="[object Set]"?Dt(Array.from(i),Array.from(t)):{}.toString.call(i)=="[object Object]"?Za(i,t):Ua(i,t)}function Ua(i,t){return i.toString()===t.toString()}function Dt(i,t){var h=i.length;if(h!=t.length)return!1;for(var e=0;e<h;e++)if(!_t(i[e],t[e]))return!1;return!0}function Za(i,t){var h=Object.keys(i),e=h.length;if(e!=Object.keys(t).length)return!1;for(var o=0;o<e;o++){var r=h[o];if(!(t.hasOwnProperty(r)&&_t(i[r],t[r])))return!1}return!0}function Ha(i,t){ye(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ke();let r=c(t,"position",8,"top-left"),x=c(t,"showCompass",8,!0),l=c(t,"showZoom",8,!0),n=c(t,"visualizePitch",8,!1),y=H(null);Ye(()=>{var I;(I=e())!=null&&I.loaded()&&a(y)&&e().removeControl(a(y))}),j(()=>(e(),a(y),b(x()),b(l()),b(n()),b(r())),()=>{e()&&!a(y)&&(S(y,new ve.NavigationControl({showCompass:x(),showZoom:l(),visualizePitch:n()})),e().addControl(a(y),r()))}),Be(),ze(),pe()}function Na(i,t){ye(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ke();let r=c(t,"position",8,"bottom-left"),x=c(t,"maxWidth",8,void 0),l=c(t,"unit",8,"metric"),n=H(null);Ye(()=>{var y;(y=e())!=null&&y.loaded()&&a(n)&&e().removeControl(a(n))}),j(()=>(e(),a(n),b(x()),b(l()),b(r())),()=>{e()&&!a(n)&&(S(n,new ve.ScaleControl({maxWidth:x(),unit:l()})),e().addControl(a(n),r()))}),Be(),ze(),pe()}var Wa=O("<!> <!> <!> <!>",1),Fa=O("<!> <!>",1),Va=O('<div data-testid="map-container"><!></div>');function Ga(i,t){ye(t,!1);const h=qe(),e=()=>oe(Q,"$mapInstance",h),o=()=>oe(Ce,"$loadedImages",h),r=H(),x=H();let l=c(t,"map",12,null),n=c(t,"mapContainer",12,void 0),y=c(t,"class",8,void 0),I=c(t,"style",8),P=c(t,"diffStyleUpdates",8,!1),z=c(t,"center",12,void 0),W=c(t,"zoom",12,void 0),T=c(t,"pitch",12,0),F=c(t,"bearing",12,0),X=c(t,"bounds",12,void 0),ie=c(t,"hash",8,!1),xe=c(t,"updateHash",8,v=>{window.history.replaceState(window.history.state,"",v)}),V=c(t,"loaded",12,!1),be=c(t,"minZoom",8,0),G=c(t,"maxZoom",8,22),de=c(t,"minPitch",8,0),q=c(t,"maxPitch",8,60),L=c(t,"renderWorldCopies",8,void 0),$=c(t,"dragPan",8,void 0),me=c(t,"dragRotate",8,void 0),le=c(t,"pitchWithRotate",8,void 0),Me=c(t,"antialias",8,void 0),se=c(t,"zoomOnDoubleClick",8,!0),Ue=c(t,"locale",8,void 0),Ie=c(t,"interactive",8,!0),w=c(t,"attributionControl",8,!0),ke=c(t,"cooperativeGestures",8,!1),Y=c(t,"preserveDrawingBuffer",8,!1),De=c(t,"maxBounds",8,void 0),ce=c(t,"images",24,()=>[]),N=c(t,"standardControls",8,!1),J=c(t,"filterLayers",8,void 0),Re=c(t,"transformRequest",8,void 0);const B=gt(),{map:Q,loadedImages:Ce}=Sa();let ue=H(new Set);async function Ee(v,m=!1){var M;if(e()&&!(!e().loaded()&&!m))if("url"in v){a(ue).add(v.id);try{let Z=await e().loadImage(v.url);(M=e())==null||M.addImage(v.id,Z.data,v.options),o().add(v.id),Pe(Ce,o())}catch(Z){B("error",Z)}finally{a(ue).delete(v.id)}}else e().addImage(v.id,v.data,v.options),o().add(v.id),Pe(Ce,o())}let ge=H(void 0),ae=H(void 0),he=H(void 0),ee=H(void 0);function Ae(v){return _(),Pe(Q,new ve.Map(Bt({container:v,style:I(),locale:Ue(),center:z(),zoom:W(),pitch:T(),bearing:F(),minZoom:be(),maxZoom:G(),minPitch:de(),maxPitch:q(),renderWorldCopies:L(),dragPan:$(),dragRotate:me(),pitchWithRotate:le(),antialias:Me(),interactive:Ie(),preserveDrawingBuffer:Y(),maxBounds:De(),bounds:X(),attributionControl:w(),transformRequest:Re(),cooperativeGestures:ke()}))),e().on("load",m=>{m.target.getContainer().setAttribute("data-testid","map"),m.target.getCanvas().setAttribute("data-testid","map-canvas"),V(!0),B("load",e())}),e().on("error",m=>B("error",{...m,map:e()})),e().on("movestart",m=>B("movestart",{...m,map:e()})),e().on("moveend",m=>{if(z(m.target.getCenter()),W(m.target.getZoom()),T(m.target.getPitch()),F(m.target.getBearing()),X(m.target.getBounds()),B("moveend",{...m,map:e()}),ie()){let M=new URL(window.location.href.replace(/(#.+)?$/,Ba(e())));xe()(M)}}),e().on("click",m=>B("click",{...m,map:e()})),e().on("dblclick",m=>B("dblclick",{...m,map:e()})),e().on("contextmenu",m=>B("contextmenu",{...m,map:e()})),e().on("zoomstart",m=>B("zoomstart",{...m,map:e()})),e().on("zoom",m=>{B("zoom",{...m,map:e()})}),e().on("zoomend",m=>{B("zoomend",{...m,map:e()})}),e().on("style.load",()=>{if(e()){const m=e().getStyle();if(S(ge,m.layers.map(M=>M.id)),S(ae,Object.keys(m.sources)),a(ee))for(const[M,Z]of Object.entries(a(ee)))e().addSource(M,Z);if(a(he))for(const M of a(he))e().addLayer(M);for(const M of ce())Ee(M,!0)}}),e().on("styledata",m=>{if(e()&&J()){const M=e().getStyle().layers;if(M)for(let Z of M)J()(Z)||e().setLayoutProperty(Z.id,"visibility","none")}B("styledata",{...m,map:e()})}),{destroy(){var m;V(!1),(m=e())==null||m.remove(),Pe(Q,null)}}}let we=H(I());function _(){if(ie()){let v=za(window.location.hash);v.length>=3&&(W(v[0]),z([v[2],v[1]])),v.length==5&&(F(v[3]),T(v[4]))}}j(()=>b(N()),()=>{S(r,typeof N()=="boolean"?void 0:N())}),j(()=>e(),()=>{l(e())}),j(()=>(e(),b(I()),a(we),a(ge),a(ae),b(P())),()=>{if(e()&&!Ve(I(),a(we))){const v=e().getStyle();if(a(ge)&&S(he,v.layers.filter(m=>!a(ge).includes(m.id))),a(ae)){const m=Object.keys(v.sources).filter(M=>!a(ae).includes(M));S(ee,{});for(const M of m)At(ee,a(ee)[M]=v.sources[M])}S(we,I()),e().setStyle(I(),{diff:P()}),Pe(Ce,new Set),S(ue,new Set)}}),j(()=>(b(V()),e(),b(ce()),o(),a(ue)),()=>{var v;if(V()&&((v=e())!=null&&v.loaded()))for(let m of ce())!o().has(m.id)&&!a(ue).has(m.id)&&!e().hasImage(m.id)&&Ee(m)}),j(()=>(b(ce()),o()),()=>{S(x,ce().every(v=>o().has(v.id)))}),j(()=>(e(),b(z()),b(W()),b(F()),b(T())),()=>{var v,m,M,Z;if(e()){let _e={};z()!=null&&!Ve(z(),(v=e())==null?void 0:v.getCenter())&&(_e.center=z()),W()!=null&&!Ve(W(),(m=e())==null?void 0:m.getZoom())&&(_e.zoom=W()),F()!=null&&!Ve(F(),(M=e())==null?void 0:M.getBearing())&&(_e.bearing=F()),T()!=null&&!Ve(T(),(Z=e())==null?void 0:Z.getPitch())&&(_e.pitch=T()),Object.keys(_e).length&&e().easeTo(_e)}}),j(()=>(b(X()),e()),()=>{var v,m;X()&&!Ve(X(),(v=e())==null?void 0:v.getBounds())&&((m=e())==null||m.fitBounds(X()))}),j(()=>(b(se()),e()),()=>{var v,m;se()?(v=e())==null||v.doubleClickZoom.enable():(m=e())==null||m.doubleClickZoom.disable()}),Be(),ze();var A=Va();Qt("hashchange",la,_);var Se=u(A);U(Se,()=>e()&&V(),v=>{var m=Fa(),M=te(m);U(M,N,_e=>{var Qe=Wa(),Ze=te(Qe);Ha(Ze,{get position(){return a(r)}});var $e=g(Ze,2);qa($e,{get position(){return a(r)},fitBoundsOptions:{maxZoom:12}});var He=g($e,2);ja(He,{get position(){return a(r)}});var et=g(He,2);Na(et,{get position(){return a(r)}}),k(_e,Qe)});var Z=g(M,2);mt(Z,t,"default",{get map(){return e()},get loadedImages(){return o()},get allImagesLoaded(){return a(x)}},null),k(v,m)}),s(A),jt(A,v=>n(v),()=>n()),ua(A,v=>Ae(v)),R(()=>{ma(A,`${y()??""} svelte-p00lfq`),ga(A,"expand-map",!y())}),k(i,A),pe()}var Ya=O("<div><!></div>");function Ka(i,t){const h=fa(t);ye(t,!1);const e=qe(),o=()=>oe(me,"$popupTarget",e),r=()=>oe($,"$map",e),x=()=>oe(Me,"$layer",e),l=()=>oe(le,"$layerEvent",e),n=H(),y=H();let I=c(t,"closeButton",8,void 0),P=c(t,"closeOnClickOutside",8,!0),z=c(t,"closeOnClickInside",8,!1),W=c(t,"closeOnMove",8,!1),T=c(t,"openOn",8,"click"),F=c(t,"openIfTopMost",8,!0),X=c(t,"focusAfterOpen",8,!0),ie=c(t,"anchor",8,void 0),xe=c(t,"offset",8,void 0),V=c(t,"popupClass",8,void 0),be=c(t,"maxWidth",8,void 0),G=c(t,"lngLat",12,void 0),de=c(t,"html",8,void 0),q=c(t,"open",12,!1);const L=gt(),{map:$,popupTarget:me,layerEvent:le,layer:Me,eventTopMost:se,markerClickManager:Ue}=Ke(),Ie=["click","dblclick","contextmenu"];let w=H(),ke=H(!1),Y=H();function De(){if(!a(w))return;let _=a(w).getElement();!_||_===a(Y)||(S(Y,_),T()==="hover"&&At(Y,a(Y).style.pointerEvents="none"),a(Y).addEventListener("mouseenter",()=>{S(ke,!0)},{passive:!0}),a(Y).addEventListener("mouseleave",()=>{S(ke,!1)},{passive:!0}),a(Y).addEventListener("click",()=>{z()&&q(!1)},{passive:!0}))}qt(()=>{if(r())return r().on("click",ae),r().on("contextmenu",ae),Ue.add(he),typeof o()=="string"&&(r().on("click",o(),B),r().on("dblclick",o(),B),r().on("contextmenu",o(),B),r().on("mousemove",o(),ge),r().on("mouseleave",o(),Ee),r().on("touchstart",o(),Ce),r().on("touchend",o(),ue)),()=>{var _,A;(_=r())!=null&&_.loaded()&&((A=a(w))==null||A.remove(),r().off("click",ae),r().off("contextmenu",ae),Ue.remove(he),o()instanceof ve.Marker?o().getPopup()===a(w)&&o().setPopup(void 0):typeof o()=="string"&&(r().off("click",o(),B),r().off("dblclick",o(),B),r().off("contextmenu",o(),B),r().off("mousemove",o(),ge),r().off("mouseleave",o(),Ee),r().off("touchstart",o(),Ce),r().off("touchend",o(),ue)))}});function ce(_){return F()?!("marker"in _)&&!Ia(_)&&se(_)!==x():!1}let N=H(null),J=H("normal");function Re(_){"layerType"in _&&_.layerType==="deckgl"?(G(_.coordinate),S(N,_.object?[_.object]:null)):(G(_.lngLat),S(N,_.features??[]))}function B(_){_.type!==T()||ce(_)||(Re(_),setTimeout(()=>q(!0)))}let Q=null;function Ce(_){Q=_.point}function ue(_){if(!Q||T()!=="hover")return;let A=Q.dist(_.point);Q=null,A<3&&(G(_.lngLat),S(N,_.features??[]),a(w).isOpen()?S(J,"justOpened"):(S(J,"opening"),q(!0)))}function Ee(_){T()!=="hover"||Q||a(J)!=="normal"||(q(!1),S(N,null))}function ge(_){if(!(T()!=="hover"||Q||a(J)!=="normal")){if(ce(_)){q(!1),S(N,null);return}q(!0),S(N,_.features??[]),G(_.lngLat)}}function ae(_){var Se;if(a(J)==="justOpened"){S(J,"normal");return}if(!P())return;let A=[a(Y),o()instanceof ve.Marker?(Se=o())==null?void 0:Se.getElement():null];q()&&a(w).isOpen()&&!A.some(v=>v==null?void 0:v.contains(_.originalEvent.target))&&(_.type==="contextmenu"&&T()==="contextmenu"||_.type!=="contextmenu")&&q(!1)}function he(_){P()&&q()&&a(w).isOpen()&&_.marker!==o()&&q(!1)}Ye(()=>{var _;r()&&((_=a(w))!=null&&_.isOpen())&&a(w).remove()});let ee=H();j(()=>(b(I()),b(P()),b(z())),()=>{S(n,I()??(!P()&&!z()))}),j(()=>(a(w),a(n),b(W()),b(X()),b(be()),b(V()),b(ie()),b(xe())),()=>{a(w)||(S(w,new ve.Popup({closeButton:a(n),closeOnClick:!1,closeOnMove:W(),focusAfterOpen:X(),maxWidth:be(),className:V(),anchor:ie(),offset:xe()})),S(Y,a(w).getElement()),a(w).on("open",()=>{q(!0),De(),L("open",a(w))}),a(w).on("close",()=>{q(!1),L("close",a(w))}),a(w).on("hover",()=>{L("hover",a(w))}))}),j(()=>(a(w),o(),b(T())),()=>{a(w)&&o()instanceof ve.Marker&&(T()==="click"?o().setPopup(a(w)):o().getPopup()===a(w)&&o().setPopup(void 0))}),j(()=>(b(T()),l()),()=>{var _;Ie.includes(T())&&((_=l())==null?void 0:_.type)===T()&&(B(l()),Pe(le,null))}),j(()=>(b(T()),l()),()=>{var _,A;S(y,T()==="hover"&&(((_=l())==null?void 0:_.type)==="mousemove"||((A=l())==null?void 0:A.type)==="mouseenter"))}),j(()=>(b(T()),a(y),l(),a(ke)),()=>{T()==="hover"&&le&&(a(y)&&l()&&Re(l()),q((a(y)||a(ke))??!1))}),j(()=>(a(ee),a(w),b(de())),()=>{a(ee)?a(w).setDOMContent(a(ee)):de()&&a(w).setHTML(de())}),j(()=>(b(G()),a(w)),()=>{G()&&a(w).setLngLat(G())}),j(()=>(r(),a(w),b(q()),a(J)),()=>{if(r()){let _=a(w).isOpen();q()&&!_?(a(w).addTo(r()),a(J)==="opening"&&S(J,"justOpened")):!q()&&_&&a(w).remove()}}),Be(),ze();var Ae=Ge(),we=te(Ae);U(we,()=>h.default,_=>{var A=Ya(),Se=u(A);U(Se,()=>{var v;return((v=a(N))==null?void 0:v.length)||o()instanceof ve.Marker},v=>{var m=Ge(),M=te(m);mt(M,t,"default",{get features(){return a(N)},get data(){var Z;return((Z=a(N))==null?void 0:Z[0])??null},get map(){return r()},close:()=>q(!1)},null),k(v,m)}),s(A),jt(A,v=>S(ee,v),()=>a(ee)),k(_,A)}),k(i,Ae),pe()}var Je=Uint8Array,zt=Uint16Array,Xa=Int32Array,Ja=new Je([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qa=new Je([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ut=function(i,t){for(var h=new zt(31),e=0;e<31;++e)h[e]=t+=1<<i[e-1];for(var o=new Xa(h[30]),e=1;e<30;++e)for(var r=h[e];r<h[e+1];++r)o[r]=r-h[e]<<5|e;return{b:h,r:o}},Zt=Ut(Ja,2),$a=Zt.b,en=Zt.r;$a[28]=258,en[258]=28;Ut(Qa,0);var tn=new zt(32768);for(E=0;E<32768;++E)Oe=(E&43690)>>1|(E&21845)<<1,Oe=(Oe&52428)>>2|(Oe&13107)<<2,Oe=(Oe&61680)>>4|(Oe&3855)<<4,tn[E]=((Oe&65280)>>8|(Oe&255)<<8)>>1;var Oe,E,at=new Je(288);for(E=0;E<144;++E)at[E]=8;var E;for(E=144;E<256;++E)at[E]=9;var E;for(E=256;E<280;++E)at[E]=7;var E;for(E=280;E<288;++E)at[E]=8;var E,an=new Je(32);for(E=0;E<32;++E)an[E]=5;var E,nn=new Je(0),rn=typeof TextDecoder<"u"&&new TextDecoder,on=0;try{rn.decode(nn,{stream:!0}),on=1}catch{}var dn=O('<a target="_blank" rel="noopener noreferrer"> </a>');function ln(i,t){ye(t,!0);function h(n){return n.padStart(6,"0")}function e(n,y){if(!y)return"";switch(n){case"DOI":return ut.DOI+y;case"EDR":case"EDH":return ut[n]+h(y);case"URI":return y;default:return ut[n]+y}}const o=vt(()=>e(t.edition.type,t.edition._)),r=vt(()=>t.edition.type==="DOI"?`DOI: ${t.edition._} (${t.edition.when})`:`${t.edition.type}: ${t.edition._}`);var x=Ge(),l=te(x);U(l,()=>t.edition._,n=>{var y=dn(),I=u(y,!0);s(y),R(()=>{re(y,"href",a(o)),C(I,a(r))}),k(n,y)},n=>{var y=ft();R(()=>C(y,`${t.edition.type??""}: -`)),k(n,y)}),k(i,x),pe()}var sn=O(", <a> </a>",1),cn=O('<section id="translations" class="svelte-xd5ukq"></section>'),un=O("<dd><a> </a></dd>"),fn=O("<dd> </dd>"),vn=O("<dd> </dd>"),mn=O("<dd> </dd>"),gn=O(" <!>",1),hn=O("<dd> </dd>"),_n=O("<dd> </dd>"),yn=O("<dd> </dd>"),pn=O("<dd> </dd>"),xn=O("<dd> <a> </a></dd>"),bn=O("<dd> </dd>"),kn=O('<div class="popup"> </div>'),Cn=O("<dt>Map</dt> <dd><!></dd>",1),wn=O("<p> </p>"),On=O("<dl><dt>Place</dt> <dd> </dd> <dt>Repository</dt> <dd><a> </a><!></dd> <dt>Autopsy</dt> <dd> </dd> <dt>Map</dt> <dd>TODO: use the geo information in the museums dataset</dd></dl>"),Ln=O("<li><!></li>"),Mn=O("<li><!></li>"),En=O('<dt>Printed editions</dt> <dd><ul class="bibliography-list"></ul></dd>',1),Sn=O('<article><hgroup><h1 class="inscription-title svelte-xd5ukq"> </h1> <p> <a> </a><!></p> <p> <a target="inscription">View in current site</a></p></hgroup> <div class="sections svelte-xd5ukq"><figure id="facsimile-images" class="svelte-xd5ukq"><section id="image-viewer" style="height: 50vh; width: 100%;" class="svelte-xd5ukq"></section> <figcaption class="svelte-xd5ukq"> </figcaption></figure> <section id="edition" class="svelte-xd5ukq"><!></section> <section id="apparatus" class="svelte-xd5ukq"><!></section> <!> <section id="physical-description" class="svelte-xd5ukq"><h2>Physical description</h2> <section class="svelte-xd5ukq"><h3>Support</h3> <dl><dt>Description</dt> <dd> </dd> <dt>Object type</dt> <!> <dt>Material</dt> <dd><a> </a></dd> <dt>Condition</dt> <!> <dt>Dimensions</dt> <dd></dd></dl></section> <section class="svelte-xd5ukq"><h3>Inscription</h3> <dl><dt>Layout</dt> <dd> </dd> <dt>Text condition</dt> <!> <dt>Lettering</dt> <dd> </dd> <dt>Letter heights</dt> <!> <dt>Interlinear heights</dt> <!></dl></section></section> <section id="provenance" class="svelte-xd5ukq"><h2>Provenance</h2> <dl><dt>Place of origin</dt> <!> <dt>Provenance found</dt> <dd> </dd> <!></dl></section> <section id="current-location" class="svelte-xd5ukq"><h2>Current location</h2> <!></section> <section id="date" class="svelte-xd5ukq"><h2>Date</h2> <!> <dl><dt>Evidence</dt> <dd> </dd></dl></section> <section id="text-type" class="svelte-xd5ukq"><h2>Text type</h2> <p><a> </a></p></section> <section id="commentary" class="svelte-xd5ukq"><!></section> <section id="bibliography" class="svelte-xd5ukq"><h2>Bibliography</h2> <dl><dt>Digital editions</dt> <dd><ul></ul></dd> <!></dl></section> <section id="citation-and-status" class="svelte-xd5ukq"><h2>Citation and editorial status</h2> <dl><dt>Citation</dt> <dd> </dd></dl></section></div></article>');function Hn(i,t){ye(t,!0);let{slug:h,metadata:e,images:o,html:r}=t.data,x=sa(ca(o[0].desc));const l=r.divs.find(f=>f.id==="edition"),n=r.divs.find(f=>f.id==="apparatus"),y=r.divs.filter(f=>f.id==="translation"),I=r.divs.find(f=>f.id==="commentary");let P=o.map(f=>`${_a}${h}/${f.url}/info.json`),z;qt(async()=>{z=(await Xt(async()=>{const{default:d}=await import("../chunks/openseadragon.CtDNE41u.js").then(p=>p.o);return{default:d}},__vite__mapDeps([0,1,2,3,4]),import.meta.url)).default,z({id:"image-viewer",prefixUrl:`${va}/openseadragon/images/`,tileSources:P,sequenceMode:!0,showReferenceStrip:!0,preserveViewport:!0}).addHandler("page",function(d){const p=o[d.page];S(x,`${p.surfaceType}, ${p.desc}`)})});var W=Sn(),T=u(W),F=u(T),X=u(F);s(F);var ie=g(F,2),xe=u(ie),V=g(xe),be=u(V,!0);s(V);var G=g(V);U(G,()=>e.objectType,f=>{var d=sn(),p=g(te(d)),D=u(p,!0);s(p),R(()=>{re(p,"href",e.objectType.ref),C(D,e.objectType._)}),k(f,d)}),s(ie);var de=g(ie,2),q=u(de),L=g(q);s(de),s(T);var $=g(T,2),me=u($),le=g(u(me),2),Me=u(le,!0);s(le),s(me);var se=g(me,2),Ue=u(se);tt(Ue,()=>l.html),s(se);var Ie=g(se,2),w=u(Ie);tt(w,()=>n.html),s(Ie);var ke=g(Ie,2);U(ke,()=>y.length,f=>{var d=cn();We(d,21,()=>y,Fe,(p,D)=>{var K=Ge(),ne=te(K);tt(ne,()=>a(D).html),k(p,K)}),s(d),k(f,d)});var Y=g(ke,2),De=g(u(Y),2),ce=g(u(De),2),N=g(u(ce),2),J=u(N,!0);s(N);var Re=g(N,4);U(Re,()=>e.objectType,f=>{var d=un(),p=u(d),D=u(p,!0);s(p),s(d),R(()=>{re(p,"href",e.objectType.ref),C(D,e.objectType._)}),k(f,d)},f=>{var d=fn(),p=u(d,!0);s(d),R(()=>C(p,fe)),k(f,d)});var B=g(Re,4),Q=u(B),Ce=u(Q,!0);s(Q),s(B);var ue=g(B,4);U(ue,()=>{var f;return(f=e.condition)==null?void 0:f.ana},f=>{var d=vn(),p=u(d,!0);R(()=>C(p,e.condition.ana.split(".").slice(1).join(", "))),s(d),k(f,d)},f=>{var d=mn(),p=u(d,!0);s(d),R(()=>C(p,e.condition._||fe)),k(f,d)});var Ee=g(ue,4);We(Ee,21,()=>e.dimensions,Fe,(f,d,p)=>{Pt();var D=gn(),K=te(D),ne=g(K);U(ne,()=>p<e.dimensions.length-1,Te=>{var je=ft(",Â ");k(Te,je)}),R(()=>C(K,`${a(d).dimension??""}: ${a(d)._??""}
							${a(d).unit??""}`)),k(f,D)}),s(Ee),s(ce),s(De);var ge=g(De,2),ae=g(u(ge),2),he=g(u(ae),2),ee=u(he,!0);s(he);var Ae=g(he,4);U(Ae,()=>e.layoutDesc.layout.damage.ana,f=>{var d=hn(),p=u(d,!0);R(()=>C(p,e.layoutDesc.layout.damage.ana.split(".").slice(1).join(", "))),s(d),k(f,d)},f=>{var d=_n(),p=u(d,!0);s(d),R(()=>C(p,e.layoutDesc.layout.damage._||fe)),k(f,d)});var we=g(Ae,4),_=u(we,!0);s(we);var A=g(we,4);We(A,17,()=>e.handNote.dimensions.filter(f=>(f==null?void 0:f.type)==="letterHeight"),Fe,(f,d)=>{var p=yn(),D=u(p);s(p),R(()=>C(D,`${a(d).l??""}: ${a(d).h??""}${a(d).unit??""}`)),k(f,p)});var Se=g(A,4);We(Se,17,()=>e.handNote.dimensions.filter(f=>(f==null?void 0:f.type)==="interlinear"),Fe,(f,d)=>{var p=pn(),D=u(p);s(p),R(()=>C(D,`${a(d).l??""}: ${a(d).h??""}${(a(d).h!=="not measured"?a(d).unit:"")??""}`)),k(f,p)}),s(ae),s(ge),s(Y);var v=g(Y,2),m=g(u(v),2),M=g(u(m),2);U(M,()=>e.places.length,f=>{var d=xn(),p=u(d),D=g(p),K=u(D,!0);s(D),s(d),R(()=>{C(p,`${(e.places[0].offset||"")??""} `),re(D,"href",e.places[0].ref),C(K,e.places[0]._)}),k(f,d)},f=>{var d=bn(),p=u(d,!0);s(d),R(()=>C(p,fe)),k(f,d)});var Z=g(M,4),_e=u(Z,!0);s(Z);var Qe=g(Z,2);U(Qe,()=>{var f;return(f=e.provenanceFound)==null?void 0:f.geo},f=>{var d=Cn();const p=vt(()=>[e.provenanceFound.geo[1],e.provenanceFound.geo[0]]);var D=g(te(d),2),K=u(D);Ga(K,{get center(){return a(p)},zoom:7,class:"map",standardControls:!0,get style(){return ya},children:(ne,Te)=>{Aa(ne,{get lngLat(){return a(p)},children:(je,lt)=>{Ka(je,{offset:[0,-10],children:(st,Xe)=>{var Ne=kn(),Gt=u(Ne,!0);s(Ne),R(()=>C(Gt,e.provenanceFound._)),k(st,Ne)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),s(D),k(f,d)}),s(m),s(v);var Ze=g(v,2),$e=g(u(Ze),2);U($e,()=>e.provenanceLost,f=>{var d=wn(),p=u(d,!0);s(d),R(()=>C(p,e.provenanceLost._)),k(f,d)},f=>{var d=On(),p=g(u(d),2),D=u(p);s(p);var K=g(p,4),ne=u(K),Te=u(ne,!0);s(ne);var je=g(ne);U(je,()=>e.idno,Xe=>{var Ne=ft();R(()=>C(Ne,`,
							${e.idno._??""}`)),k(Xe,Ne)}),s(K);var lt=g(K,4),st=u(lt,!0);s(lt),Pt(4),s(d),R(()=>{var Xe;C(D,`${e.settlement??""}, ${e.country??""}`),re(ne,"href",e.repository.ref),C(Te,e.repository._),C(st,((Xe=e.provenanceObserved)==null?void 0:Xe._)||fe)}),k(f,d)}),s(Ze);var He=g(Ze,2),et=g(u(He),2);ha(et,{inscription:e});var yt=g(et,2),pt=g(u(yt),2),Ht=u(pt,!0);s(pt),s(yt),s(He);var nt=g(He,2),xt=g(u(nt),2),rt=u(xt),Nt=u(rt,!0);s(rt),s(xt),s(nt);var ot=g(nt,2),Wt=u(ot);tt(Wt,()=>I.html),s(ot);var it=g(ot,2),bt=g(u(it),2),dt=g(u(bt),2),kt=u(dt);We(kt,21,()=>e.editions,Fe,(f,d)=>{var p=Ln(),D=u(p);ln(D,{get edition(){return a(d)}}),s(p),k(f,p)}),s(kt),s(dt);var Ft=g(dt,2);U(Ft,()=>{var f,d;return(d=(f=e.bibliographyEdition)==null?void 0:f.bibl)==null?void 0:d.length},f=>{var d=En(),p=g(te(d),2),D=u(p);We(D,21,()=>e.bibliographyEdition.bibl,Fe,(K,ne)=>{var Te=Mn(),je=u(Te);Ma(je,{get entry(){return a(ne)}}),s(Te),k(K,Te)}),s(D),s(p),k(f,d)}),s(bt),s(it);var Ct=g(it,2),wt=g(u(Ct),2),Ot=g(u(wt),2),Vt=u(Ot,!0);s(Ot),s(wt),s(Ct),s($),s(W),R(()=>{var f;C(X,`${e.file??""}: ${e.title??""}`),C(xe,`${e.textLang._??""}, `),re(V,"href",e.type.ref),C(be,e.type._),C(q,`${e.status??""}, `),re(L,"href",`${pa}inscription/${h??""}`),C(Me,a(x)),C(J,e.support||fe),re(Q,"href",e.material.ref),C(Ce,e.material._),C(ee,e.layoutDesc.layout.p||fe),C(_,e.handNote.lettering||fe),C(_e,((f=e.provenanceFound)==null?void 0:f._)||fe),C(Ht,e.evidence||fe),re(rt,"href",e.type.ref),C(Nt,e.type._),C(Vt,e.citation||fe)}),k(i,W),pe()}export{Hn as component};
