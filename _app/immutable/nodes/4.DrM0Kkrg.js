const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/openseadragon.D2bpRMoO.js","../chunks/maplibre-gl.BKqjIULy.js","../chunks/utils.CgqR5BiE.js","../chunks/disclose-version.BwBVlfMN.js","../assets/maplibre-gl.CuCRB34y.css"])))=>i.map(i=>d[i]);
var Kt=Object.defineProperty;var Yt=(i,t,h)=>t in i?Kt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):i[t]=h;var Lt=(i,t,h)=>Yt(i,typeof t!="symbol"?t+"":t,h);import{_ as Qt}from"../chunks/preload-helper.C1FmrZbK.js";import{q as Mt,r as Xt,a as k,d as Ge,t as O,b as C,s as qe,v as Te,c as oe,w as Jt,e as ft}from"../chunks/disclose-version.BwBVlfMN.js";import{h as $t,k as Et,m as Pt,j as ea,q as St,a8 as ta,aI as aa,aH as na,O as ra,a2 as oa,a1 as ia,p as pe,f as te,e as u,r as s,t as R,s as g,d as ye,aL as da,aM as Rt,aN as j,aO as Be,C as x,g as a,aP as Z,v as P,aQ as la,aR as At,D as vt,K as sa,n as Tt}from"../chunks/utils.CgqR5BiE.js";import{i as H,p as c,b as jt,a as ca}from"../chunks/props.IFVwysL6.js";import{b as re,s as mt,c as ua,d as fa,e as Ne,i as We}from"../chunks/attributes.Bxrms_db.js";import{c as gt,a as Ke,o as qt}from"../chunks/index-client.Cj9I2f6z.js";import{w as Le,r as ct,b as va}from"../chunks/paths.2lx5Ozcx.js";import{m as ve,s as ma,t as ga,I as ha}from"../chunks/maplibre-gl.BKqjIULy.js";import{d as ut,i as _a,E as fe,p as pa}from"../chunks/config.CknchF6G.js";import{i as ze}from"../chunks/legacy.DeTa_azy.js";function tt(i,t,h,e,o){var r=i,b="",l;$t(()=>{if(b===(b=t()??"")){Et&&Pt();return}l!==void 0&&(ia(l),l=void 0),b!==""&&(l=ea(()=>{if(Et){St.data;for(var n=Pt(),p=n;n!==null&&(n.nodeType!==8||n.data!=="");)p=n,n=ta(n);if(n===null)throw aa(),na;Mt(St,p),r=ra(n);return}var I=b+"",T=Xt(I);Mt(oa(T),T.lastChild),r.before(T)}))})}var ya=O("<span> </span>"),ba=O("<span> </span>"),xa=O("<a> </a>"),ka=O("<span> </span>"),Ca=O("<a>Zotero</a>"),wa=O("<a>FAIR</a>"),Oa=O("<!> <!> <!> <!>",1);function La(i,t){pe(t,!0);var h=Oa(),e=te(h);H(e,()=>t.entry.type==="bulletin"||t.entry.type==="corpus",l=>{var n=ya(),p=u(n);s(n),R(()=>C(p,`${t.entry.n??""} ${(t.entry.author?`${t.entry.author} (${t.entry.date})`:"")??""}`)),k(l,n)},l=>{var n=ba(),p=u(n);s(n),R(()=>C(p,`${t.entry.author??""} (${t.entry.date??""})`)),k(l,n)});var o=g(e,2);H(o,()=>{var l;return typeof t.entry.citedRange=="object"&&((l=t.entry.citedRange)==null?void 0:l.ref)},l=>{var n=xa(),p=u(n,!0);s(n),R(()=>{re(n,"href",t.entry.citedRange.ref.target),C(p,t.entry.citedRange.ref._)}),k(l,n)},l=>{var n=Ge(),p=te(n);H(p,()=>t.entry.citedRange,I=>{var T=ka(),z=u(T,!0);s(T),R(()=>C(z,t.entry.citedRange)),k(I,T)},null,!0),k(l,n)});var r=g(o,2);H(r,()=>{var l;return(l=t.entry.ptr)==null?void 0:l.target},l=>{var n=Ca();R(()=>{var p;return re(n,"href",(p=t.entry.ptr)==null?void 0:p.target)}),k(l,n)});var b=g(r,2);H(b,()=>{var l;return(l=t.entry.ref)==null?void 0:l.target},l=>{var n=wa();R(()=>re(n,"href",t.entry.ref.target)),k(l,n)}),k(i,h),ye()}const ht=Symbol.for("svelte-maplibre");function Ye(){return da(ht)}function Ma(i){let t=new WeakMap;return h=>{var b;let e=t.get(h.originalEvent);if(e!==void 0)return e;let r=(b=h.target.queryRenderedFeatures(h.point).find(l=>{var n;return(n=i.get(l.layer.id))==null?void 0:n.interactive}))==null?void 0:b.layer.id;return t.set(h.originalEvent,r),r}}function Ea(){let i=new Map;return Rt(ht,{map:Le(null),source:ct(null),layer:ct(null),popupTarget:ct(null),cluster:Le(),loadedImages:Le(new Set),minzoom:Le(0),maxzoom:Le(24),layerEvent:Le(null),layerInfo:i,eventTopMost:Ma(i),markerClickManager:new Ia})}function It(i){return{subscribe:i.subscribe}}function Pa({key:i,setPopupTarget:t=!1,setCluster:h=!1,setMouseEvent:e=!1}){let o=Ye(),r=Le(null),b=It(r),l={...o,[i]:It(r)};if(t&&(l.popupTarget=b),e){let n=Le(null);l.layerEvent=n,o.layerEvent=n}return h&&(l.cluster=Le()),Rt(ht,l),{...o,self:r}}function Sa(){return Pa({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Ta(i){return"layerType"in i&&i.layerType==="deckgl"}class Ia{constructor(){Lt(this,"_handlers",new Set)}add(t){this._handlers.add(t)}remove(t){this._handlers.delete(t)}handleClick(t){for(const h of this._handlers)h(t)}}var Bt=Da;function Da(i){var t,h,e;if(i){if(Array.isArray(i)){for(t=[],h=i.length,e=0;e<h;e++){var o=i[e];o!=null&&t.push(o)}return t}if(typeof i=="object"){t={};var r=Object.keys(i);for(h=r.length,e=0;e<h;e++){var b=r[e],l=i[b];l!=null&&(t[b]=l)}return t}}}function Ra(i,t){pe(t,!1);const h=qe(),e=()=>oe(Q,"$marker",h),o=()=>oe(S,"$map",h);let r=c(t,"marker",12,void 0),b=c(t,"lngLat",12),l=c(t,"class",8,void 0),n=c(t,"draggable",8,!1),p=c(t,"feature",8,null),I=c(t,"offset",8,void 0),T=c(t,"rotation",8,0),z=c(t,"opacity",8,1);const N=gt(),{map:S,layerEvent:W,self:Q}=Sa(),ie=()=>G("dragstart"),be=()=>{xe(),G("drag")},V=()=>{xe(),G("dragend")};Te(Q,new ve.Marker(Bt({draggable:n(),rotation:T(),className:l(),offset:I(),opacity:z().toString()})).setLngLat(b()).addTo(o())),r(e()),n()&&(e().on("dragstart",ie),e().on("drag",be),e().on("dragend",V)),Ke(()=>{var L;r(void 0),(L=e())==null||L.remove()});function xe(){var $;let L=($=e())==null?void 0:$.getLngLat();L&&(Array.isArray(b())?b([L.lng,L.lat]):b()&&"lon"in b()?b({lon:L.lng,lat:L.lat}):b(L))}function G(L){var Me,se;let $=(Me=e())==null?void 0:Me.getLngLat();if(!$)return;const me=[$.lng,$.lat];let le={map:o(),marker:e(),lngLat:me,features:[{type:"Feature",properties:((se=p())==null?void 0:se.properties)??{},geometry:{type:"Point",coordinates:me}}]};Te(W,{...le,layerType:"marker",type:L}),N(L,le)}j(()=>(e(),x(b())),()=>{var L;(L=e())==null||L.setLngLat(b())}),j(()=>(e(),x(I())),()=>{var L;(L=e())==null||L.setOffset(I()??[0,0])}),j(()=>(e(),x(T())),()=>{var L;(L=e())==null||L.setRotation(T())}),j(()=>(e(),x(z())),()=>{var L;(L=e())==null||L.setOpacity(z().toString())}),Be(),ze();var de=Ge(),q=te(de);mt(q,t,"default",{get marker(){return e()}},null),k(i,de),ye()}function Aa(i,t){pe(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ye();let r=c(t,"position",8,"top-left"),b=c(t,"container",8,void 0),l=Z(null);Ke(()=>{var n;(n=e())!=null&&n.loaded()&&a(l)&&e().removeControl(a(l))}),j(()=>(e(),a(l),x(b()),x(r())),()=>{if(e()&&!a(l)){let n;typeof b()=="string"?n=document.querySelector(b())??void 0:n=b(),P(l,new ve.FullscreenControl({container:n})),e().addControl(a(l),r())}}),Be(),ze(),ye()}function ja(i,t){pe(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ye();let r=c(t,"position",8,"top-left"),b=c(t,"positionOptions",8,void 0),l=c(t,"fitBoundsOptions",8,void 0),n=c(t,"trackUserLocation",8,!1),p=c(t,"showAccuracyCircle",8,!0),I=c(t,"showUserLocation",8,!0),T=c(t,"control",12,null);Ke(()=>{var z;(z=e())!=null&&z.loaded()&&T()&&e().removeControl(T())}),j(()=>(e(),x(T()),x(b()),x(l()),x(n()),x(p()),x(I()),x(r())),()=>{e()&&!T()&&(T(new ve.GeolocateControl({positionOptions:b(),fitBoundsOptions:l(),trackUserLocation:n(),showAccuracyCircle:p(),showUserLocation:I()})),e().addControl(T(),r()))}),Be(),ze(),ye()}function qa(i){let t=i.getCenter(),h=Math.round(i.getZoom()*100)/100,e=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,e),r=Math.round(t.lat*o)/o,b=Math.round(t.lng*o)/o,l=`${h}/${r}/${b}`,n=i.getBearing(),p=i.getPitch();return(n||p)&&(l+=`/${Math.round(n*10)/10}`),p&&(l+=`/${Math.round(p)}`),`#${l}`}function Ba(i){return i.replace("#","").split("/").map(parseFloat)}var Ve=_t;function _t(i,t){return i===t||i!==i&&t!==t?!0:typeof i!=typeof t||{}.toString.call(i)!={}.toString.call(t)||i!==Object(i)||!i?!1:Array.isArray(i)?Dt(i,t):{}.toString.call(i)=="[object Set]"?Dt(Array.from(i),Array.from(t)):{}.toString.call(i)=="[object Object]"?Ha(i,t):za(i,t)}function za(i,t){return i.toString()===t.toString()}function Dt(i,t){var h=i.length;if(h!=t.length)return!1;for(var e=0;e<h;e++)if(!_t(i[e],t[e]))return!1;return!0}function Ha(i,t){var h=Object.keys(i),e=h.length;if(e!=Object.keys(t).length)return!1;for(var o=0;o<e;o++){var r=h[o];if(!(t.hasOwnProperty(r)&&_t(i[r],t[r])))return!1}return!0}function Ua(i,t){pe(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ye();let r=c(t,"position",8,"top-left"),b=c(t,"showCompass",8,!0),l=c(t,"showZoom",8,!0),n=c(t,"visualizePitch",8,!1),p=Z(null);Ke(()=>{var I;(I=e())!=null&&I.loaded()&&a(p)&&e().removeControl(a(p))}),j(()=>(e(),a(p),x(b()),x(l()),x(n()),x(r())),()=>{e()&&!a(p)&&(P(p,new ve.NavigationControl({showCompass:b(),showZoom:l(),visualizePitch:n()})),e().addControl(a(p),r()))}),Be(),ze(),ye()}function Za(i,t){pe(t,!1);const h=qe(),e=()=>oe(o,"$map",h),{map:o}=Ye();let r=c(t,"position",8,"bottom-left"),b=c(t,"maxWidth",8,void 0),l=c(t,"unit",8,"metric"),n=Z(null);Ke(()=>{var p;(p=e())!=null&&p.loaded()&&a(n)&&e().removeControl(a(n))}),j(()=>(e(),a(n),x(b()),x(l()),x(r())),()=>{e()&&!a(n)&&(P(n,new ve.ScaleControl({maxWidth:b(),unit:l()})),e().addControl(a(n),r()))}),Be(),ze(),ye()}var Fa=O("<!> <!> <!> <!>",1),Na=O("<!> <!>",1),Wa=O('<div data-testid="map-container"><!></div>');function Va(i,t){pe(t,!1);const h=qe(),e=()=>oe(J,"$mapInstance",h),o=()=>oe(Ce,"$loadedImages",h),r=Z(),b=Z();let l=c(t,"map",12,null),n=c(t,"mapContainer",12,void 0),p=c(t,"class",8,void 0),I=c(t,"style",8),T=c(t,"diffStyleUpdates",8,!1),z=c(t,"center",12,void 0),N=c(t,"zoom",12,void 0),S=c(t,"pitch",12,0),W=c(t,"bearing",12,0),Q=c(t,"bounds",12,void 0),ie=c(t,"hash",8,!1),be=c(t,"updateHash",8,v=>{window.history.replaceState(window.history.state,"",v)}),V=c(t,"loaded",12,!1),xe=c(t,"minZoom",8,0),G=c(t,"maxZoom",8,22),de=c(t,"minPitch",8,0),q=c(t,"maxPitch",8,60),L=c(t,"renderWorldCopies",8,void 0),$=c(t,"dragPan",8,void 0),me=c(t,"dragRotate",8,void 0),le=c(t,"pitchWithRotate",8,void 0),Me=c(t,"antialias",8,void 0),se=c(t,"zoomOnDoubleClick",8,!0),He=c(t,"locale",8,void 0),Ie=c(t,"interactive",8,!0),w=c(t,"attributionControl",8,!0),ke=c(t,"cooperativeGestures",8,!1),K=c(t,"preserveDrawingBuffer",8,!1),De=c(t,"maxBounds",8,void 0),ce=c(t,"images",24,()=>[]),F=c(t,"standardControls",8,!1),X=c(t,"filterLayers",8,void 0),Re=c(t,"transformRequest",8,void 0);const B=gt(),{map:J,loadedImages:Ce}=Ea();let ue=Z(new Set);async function Ee(v,m=!1){var M;if(e()&&!(!e().loaded()&&!m))if("url"in v){a(ue).add(v.id);try{let U=await e().loadImage(v.url);(M=e())==null||M.addImage(v.id,U.data,v.options),o().add(v.id),Te(Ce,o())}catch(U){B("error",U)}finally{a(ue).delete(v.id)}}else e().addImage(v.id,v.data,v.options),o().add(v.id),Te(Ce,o())}let ge=Z(void 0),ae=Z(void 0),he=Z(void 0),ee=Z(void 0);function Ae(v){return _(),Te(J,new ve.Map(Bt({container:v,style:I(),locale:He(),center:z(),zoom:N(),pitch:S(),bearing:W(),minZoom:xe(),maxZoom:G(),minPitch:de(),maxPitch:q(),renderWorldCopies:L(),dragPan:$(),dragRotate:me(),pitchWithRotate:le(),antialias:Me(),interactive:Ie(),preserveDrawingBuffer:K(),maxBounds:De(),bounds:Q(),attributionControl:w(),transformRequest:Re(),cooperativeGestures:ke()}))),e().on("load",m=>{m.target.getContainer().setAttribute("data-testid","map"),m.target.getCanvas().setAttribute("data-testid","map-canvas"),V(!0),B("load",e())}),e().on("error",m=>B("error",{...m,map:e()})),e().on("movestart",m=>B("movestart",{...m,map:e()})),e().on("moveend",m=>{if(z(m.target.getCenter()),N(m.target.getZoom()),S(m.target.getPitch()),W(m.target.getBearing()),Q(m.target.getBounds()),B("moveend",{...m,map:e()}),ie()){let M=new URL(window.location.href.replace(/(#.+)?$/,qa(e())));be()(M)}}),e().on("click",m=>B("click",{...m,map:e()})),e().on("dblclick",m=>B("dblclick",{...m,map:e()})),e().on("contextmenu",m=>B("contextmenu",{...m,map:e()})),e().on("zoomstart",m=>B("zoomstart",{...m,map:e()})),e().on("zoom",m=>{B("zoom",{...m,map:e()})}),e().on("zoomend",m=>{B("zoomend",{...m,map:e()})}),e().on("style.load",()=>{if(e()){const m=e().getStyle();if(P(ge,m.layers.map(M=>M.id)),P(ae,Object.keys(m.sources)),a(ee))for(const[M,U]of Object.entries(a(ee)))e().addSource(M,U);if(a(he))for(const M of a(he))e().addLayer(M);for(const M of ce())Ee(M,!0)}}),e().on("styledata",m=>{if(e()&&X()){const M=e().getStyle().layers;if(M)for(let U of M)X()(U)||e().setLayoutProperty(U.id,"visibility","none")}B("styledata",{...m,map:e()})}),{destroy(){var m;V(!1),(m=e())==null||m.remove(),Te(J,null)}}}let we=Z(I());function _(){if(ie()){let v=Ba(window.location.hash);v.length>=3&&(N(v[0]),z([v[2],v[1]])),v.length==5&&(W(v[3]),S(v[4]))}}j(()=>x(F()),()=>{P(r,typeof F()=="boolean"?void 0:F())}),j(()=>e(),()=>{l(e())}),j(()=>(e(),x(I()),a(we),a(ge),a(ae),x(T())),()=>{if(e()&&!Ve(I(),a(we))){const v=e().getStyle();if(a(ge)&&P(he,v.layers.filter(m=>!a(ge).includes(m.id))),a(ae)){const m=Object.keys(v.sources).filter(M=>!a(ae).includes(M));P(ee,{});for(const M of m)At(ee,a(ee)[M]=v.sources[M])}P(we,I()),e().setStyle(I(),{diff:T()}),Te(Ce,new Set),P(ue,new Set)}}),j(()=>(x(V()),e(),x(ce()),o(),a(ue)),()=>{var v;if(V()&&((v=e())!=null&&v.loaded()))for(let m of ce())!o().has(m.id)&&!a(ue).has(m.id)&&!e().hasImage(m.id)&&Ee(m)}),j(()=>(x(ce()),o()),()=>{P(b,ce().every(v=>o().has(v.id)))}),j(()=>(e(),x(z()),x(N()),x(W()),x(S())),()=>{var v,m,M,U;if(e()){let _e={};z()!=null&&!Ve(z(),(v=e())==null?void 0:v.getCenter())&&(_e.center=z()),N()!=null&&!Ve(N(),(m=e())==null?void 0:m.getZoom())&&(_e.zoom=N()),W()!=null&&!Ve(W(),(M=e())==null?void 0:M.getBearing())&&(_e.bearing=W()),S()!=null&&!Ve(S(),(U=e())==null?void 0:U.getPitch())&&(_e.pitch=S()),Object.keys(_e).length&&e().easeTo(_e)}}),j(()=>(x(Q()),e()),()=>{var v,m;Q()&&!Ve(Q(),(v=e())==null?void 0:v.getBounds())&&((m=e())==null||m.fitBounds(Q()))}),j(()=>(x(se()),e()),()=>{var v,m;se()?(v=e())==null||v.doubleClickZoom.enable():(m=e())==null||m.doubleClickZoom.disable()}),Be(),ze();var A=Wa();Jt("hashchange",la,_);var Pe=u(A);H(Pe,()=>e()&&V(),v=>{var m=Na(),M=te(m);H(M,F,_e=>{var Je=Fa(),Ue=te(Je);Ua(Ue,{get position(){return a(r)}});var $e=g(Ue,2);ja($e,{get position(){return a(r)},fitBoundsOptions:{maxZoom:12}});var Ze=g($e,2);Aa(Ze,{get position(){return a(r)}});var et=g(Ze,2);Za(et,{get position(){return a(r)}}),k(_e,Je)});var U=g(M,2);mt(U,t,"default",{get map(){return e()},get loadedImages(){return o()},get allImagesLoaded(){return a(b)}},null),k(v,m)}),s(A),jt(A,v=>n(v),()=>n()),ua(A,v=>Ae(v)),R(()=>{ma(A,`${p()??""} svelte-p00lfq`),ga(A,"expand-map",!p())}),k(i,A),ye()}var Ga=O("<div><!></div>");function Ka(i,t){const h=fa(t);pe(t,!1);const e=qe(),o=()=>oe(me,"$popupTarget",e),r=()=>oe($,"$map",e),b=()=>oe(Me,"$layer",e),l=()=>oe(le,"$layerEvent",e),n=Z(),p=Z();let I=c(t,"closeButton",8,void 0),T=c(t,"closeOnClickOutside",8,!0),z=c(t,"closeOnClickInside",8,!1),N=c(t,"closeOnMove",8,!1),S=c(t,"openOn",8,"click"),W=c(t,"openIfTopMost",8,!0),Q=c(t,"focusAfterOpen",8,!0),ie=c(t,"anchor",8,void 0),be=c(t,"offset",8,void 0),V=c(t,"popupClass",8,void 0),xe=c(t,"maxWidth",8,void 0),G=c(t,"lngLat",12,void 0),de=c(t,"html",8,void 0),q=c(t,"open",12,!1);const L=gt(),{map:$,popupTarget:me,layerEvent:le,layer:Me,eventTopMost:se,markerClickManager:He}=Ye(),Ie=["click","dblclick","contextmenu"];let w=Z(),ke=Z(!1),K=Z();function De(){if(!a(w))return;let _=a(w).getElement();!_||_===a(K)||(P(K,_),S()==="hover"&&At(K,a(K).style.pointerEvents="none"),a(K).addEventListener("mouseenter",()=>{P(ke,!0)},{passive:!0}),a(K).addEventListener("mouseleave",()=>{P(ke,!1)},{passive:!0}),a(K).addEventListener("click",()=>{z()&&q(!1)},{passive:!0}))}qt(()=>{if(r())return r().on("click",ae),r().on("contextmenu",ae),He.add(he),typeof o()=="string"&&(r().on("click",o(),B),r().on("dblclick",o(),B),r().on("contextmenu",o(),B),r().on("mousemove",o(),ge),r().on("mouseleave",o(),Ee),r().on("touchstart",o(),Ce),r().on("touchend",o(),ue)),()=>{var _,A;(_=r())!=null&&_.loaded()&&((A=a(w))==null||A.remove(),r().off("click",ae),r().off("contextmenu",ae),He.remove(he),o()instanceof ve.Marker?o().getPopup()===a(w)&&o().setPopup(void 0):typeof o()=="string"&&(r().off("click",o(),B),r().off("dblclick",o(),B),r().off("contextmenu",o(),B),r().off("mousemove",o(),ge),r().off("mouseleave",o(),Ee),r().off("touchstart",o(),Ce),r().off("touchend",o(),ue)))}});function ce(_){return W()?!("marker"in _)&&!Ta(_)&&se(_)!==b():!1}let F=Z(null),X=Z("normal");function Re(_){"layerType"in _&&_.layerType==="deckgl"?(G(_.coordinate),P(F,_.object?[_.object]:null)):(G(_.lngLat),P(F,_.features??[]))}function B(_){_.type!==S()||ce(_)||(Re(_),setTimeout(()=>q(!0)))}let J=null;function Ce(_){J=_.point}function ue(_){if(!J||S()!=="hover")return;let A=J.dist(_.point);J=null,A<3&&(G(_.lngLat),P(F,_.features??[]),a(w).isOpen()?P(X,"justOpened"):(P(X,"opening"),q(!0)))}function Ee(_){S()!=="hover"||J||a(X)!=="normal"||(q(!1),P(F,null))}function ge(_){if(!(S()!=="hover"||J||a(X)!=="normal")){if(ce(_)){q(!1),P(F,null);return}q(!0),P(F,_.features??[]),G(_.lngLat)}}function ae(_){var Pe;if(a(X)==="justOpened"){P(X,"normal");return}if(!T())return;let A=[a(K),o()instanceof ve.Marker?(Pe=o())==null?void 0:Pe.getElement():null];q()&&a(w).isOpen()&&!A.some(v=>v==null?void 0:v.contains(_.originalEvent.target))&&(_.type==="contextmenu"&&S()==="contextmenu"||_.type!=="contextmenu")&&q(!1)}function he(_){T()&&q()&&a(w).isOpen()&&_.marker!==o()&&q(!1)}Ke(()=>{var _;r()&&((_=a(w))!=null&&_.isOpen())&&a(w).remove()});let ee=Z();j(()=>(x(I()),x(T()),x(z())),()=>{P(n,I()??(!T()&&!z()))}),j(()=>(a(w),a(n),x(N()),x(Q()),x(xe()),x(V()),x(ie()),x(be())),()=>{a(w)||(P(w,new ve.Popup({closeButton:a(n),closeOnClick:!1,closeOnMove:N(),focusAfterOpen:Q(),maxWidth:xe(),className:V(),anchor:ie(),offset:be()})),P(K,a(w).getElement()),a(w).on("open",()=>{q(!0),De(),L("open",a(w))}),a(w).on("close",()=>{q(!1),L("close",a(w))}),a(w).on("hover",()=>{L("hover",a(w))}))}),j(()=>(a(w),o(),x(S())),()=>{a(w)&&o()instanceof ve.Marker&&(S()==="click"?o().setPopup(a(w)):o().getPopup()===a(w)&&o().setPopup(void 0))}),j(()=>(x(S()),l()),()=>{var _;Ie.includes(S())&&((_=l())==null?void 0:_.type)===S()&&(B(l()),Te(le,null))}),j(()=>(x(S()),l()),()=>{var _,A;P(p,S()==="hover"&&(((_=l())==null?void 0:_.type)==="mousemove"||((A=l())==null?void 0:A.type)==="mouseenter"))}),j(()=>(x(S()),a(p),l(),a(ke)),()=>{S()==="hover"&&le&&(a(p)&&l()&&Re(l()),q((a(p)||a(ke))??!1))}),j(()=>(a(ee),a(w),x(de())),()=>{a(ee)?a(w).setDOMContent(a(ee)):de()&&a(w).setHTML(de())}),j(()=>(x(G()),a(w)),()=>{G()&&a(w).setLngLat(G())}),j(()=>(r(),a(w),x(q()),a(X)),()=>{if(r()){let _=a(w).isOpen();q()&&!_?(a(w).addTo(r()),a(X)==="opening"&&P(X,"justOpened")):!q()&&_&&a(w).remove()}}),Be(),ze();var Ae=Ge(),we=te(Ae);H(we,()=>h.default,_=>{var A=Ga(),Pe=u(A);H(Pe,()=>{var v;return((v=a(F))==null?void 0:v.length)||o()instanceof ve.Marker},v=>{var m=Ge(),M=te(m);mt(M,t,"default",{get features(){return a(F)},get data(){var U;return((U=a(F))==null?void 0:U[0])??null},get map(){return r()},close:()=>q(!1)},null),k(v,m)}),s(A),jt(A,v=>P(ee,v),()=>a(ee)),k(_,A)}),k(i,Ae),ye()}var Xe=Uint8Array,zt=Uint16Array,Ya=Int32Array,Qa=new Xe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Xa=new Xe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ht=function(i,t){for(var h=new zt(31),e=0;e<31;++e)h[e]=t+=1<<i[e-1];for(var o=new Ya(h[30]),e=1;e<30;++e)for(var r=h[e];r<h[e+1];++r)o[r]=r-h[e]<<5|e;return{b:h,r:o}},Ut=Ht(Qa,2),Ja=Ut.b,$a=Ut.r;Ja[28]=258,$a[258]=28;Ht(Xa,0);var en=new zt(32768);for(E=0;E<32768;++E)Oe=(E&43690)>>1|(E&21845)<<1,Oe=(Oe&52428)>>2|(Oe&13107)<<2,Oe=(Oe&61680)>>4|(Oe&3855)<<4,en[E]=((Oe&65280)>>8|(Oe&255)<<8)>>1;var Oe,E,at=new Xe(288);for(E=0;E<144;++E)at[E]=8;var E;for(E=144;E<256;++E)at[E]=9;var E;for(E=256;E<280;++E)at[E]=7;var E;for(E=280;E<288;++E)at[E]=8;var E,tn=new Xe(32);for(E=0;E<32;++E)tn[E]=5;var E,an=new Xe(0),nn=typeof TextDecoder<"u"&&new TextDecoder,rn=0;try{nn.decode(an,{stream:!0}),rn=1}catch{}var on=O('<a target="_blank" rel="noopener noreferrer"> </a>');function dn(i,t){pe(t,!0);function h(n){return n.padStart(6,"0")}function e(n,p){if(!p)return"";switch(n){case"DOI":return ut.DOI+p;case"EDR":case"EDH":return ut[n]+h(p);case"URI":return p;default:return ut[n]+p}}const o=vt(()=>e(t.edition.type,t.edition._)),r=vt(()=>t.edition.type==="DOI"?`DOI: ${t.edition._} (${t.edition.when})`:`${t.edition.type}: ${t.edition._}`);var b=Ge(),l=te(b);H(l,()=>t.edition._,n=>{var p=on(),I=u(p,!0);s(p),R(()=>{re(p,"href",a(o)),C(I,a(r))}),k(n,p)},n=>{var p=ft();R(()=>C(p,`${t.edition.type??""}: -`)),k(n,p)}),k(i,b),ye()}var ln=O(", <a> </a>",1),sn=O('<section id="translations" class="svelte-xd5ukq"></section>'),cn=O("<dd><a> </a></dd>"),un=O("<dd> </dd>"),fn=O("<dd> </dd>"),vn=O("<dd> </dd>"),mn=O(" <!>",1),gn=O("<dd> </dd>"),hn=O("<dd> </dd>"),_n=O("<dd> </dd>"),pn=O("<dd> </dd>"),yn=O("<dd> <a> </a></dd>"),bn=O("<dd> </dd>"),xn=O('<div class="popup"> </div>'),kn=O("<dt>Map</dt> <dd><!></dd>",1),Cn=O("<p> </p>"),wn=O("<dl><dt>Place</dt> <dd> </dd> <dt>Repository</dt> <dd><a> </a><!></dd> <dt>Autopsy</dt> <dd> </dd> <dt>Map</dt> <dd>TODO: use the geo information in the museums dataset</dd></dl>"),On=O("<li><!></li>"),Ln=O("<li><!></li>"),Mn=O('<dt>Printed editions</dt> <dd><ul class="bibliography-list"></ul></dd>',1),En=O('<article><hgroup><h1 class="inscription-title svelte-xd5ukq"> </h1> <p> <a> </a><!></p> <p> <a target="inscription">View in current site</a></p></hgroup> <div class="sections svelte-xd5ukq"><figure id="facsimile-images" class="svelte-xd5ukq"><section id="image-viewer" style="height: 50vh; width: 100%;" class="svelte-xd5ukq"></section> <figcaption class="svelte-xd5ukq"> </figcaption></figure> <section id="edition" class="svelte-xd5ukq"><!></section> <section id="apparatus" class="svelte-xd5ukq"><!></section> <!> <section id="physical-description" class="svelte-xd5ukq"><h2>Physical description</h2> <section class="svelte-xd5ukq"><h3>Support</h3> <dl><dt>Description</dt> <dd> </dd> <dt>Object type</dt> <!> <dt>Material</dt> <dd><a> </a></dd> <dt>Condition</dt> <!> <dt>Dimensions</dt> <dd></dd></dl></section> <section class="svelte-xd5ukq"><h3>Inscription</h3> <dl><dt>Layout</dt> <dd> </dd> <dt>Text condition</dt> <!> <dt>Lettering</dt> <dd> </dd> <dt>Letter heights</dt> <!> <dt>Interlinear heights</dt> <!></dl></section></section> <section id="provenance" class="svelte-xd5ukq"><h2>Provenance</h2> <dl><dt>Place of origin</dt> <!> <dt>Provenance found</dt> <dd> </dd> <!></dl></section> <section id="current-location" class="svelte-xd5ukq"><h2>Current location</h2> <!></section> <section id="date" class="svelte-xd5ukq"><h2>Date</h2> <!> <dl><dt>Evidence</dt> <dd> </dd></dl></section> <section id="text-type" class="svelte-xd5ukq"><h2>Text type</h2> <p><a> </a></p></section> <section id="commentary" class="svelte-xd5ukq"><!></section> <section id="bibliography" class="svelte-xd5ukq"><h2>Bibliography</h2> <dl><dt>Digital editions</dt> <dd><ul></ul></dd> <!></dl></section> <section id="citation-and-status" class="svelte-xd5ukq"><h2>Citation and editorial status</h2> <dl><dt>Citation</dt> <dd> </dd></dl></section></div></article>');function Un(i,t){pe(t,!0);let{slug:h,metadata:e,images:o,html:r}=t.data,b=sa(ca(o[0].desc));const l=r.divs.find(f=>f.id==="edition"),n=r.divs.find(f=>f.id==="apparatus"),p=r.divs.filter(f=>f.id==="translation"),I=r.divs.find(f=>f.id==="commentary");let T=o.map(f=>`${_a}${h}/${f.url}/info.json`),z;qt(async()=>{z=(await Qt(async()=>{const{default:d}=await import("../chunks/openseadragon.D2bpRMoO.js").then(y=>y.o);return{default:d}},__vite__mapDeps([0,1,2,3,4]),import.meta.url)).default,z({id:"image-viewer",prefixUrl:`${va}/openseadragon/images/`,tileSources:T,sequenceMode:!0,showReferenceStrip:!0,preserveViewport:!0}).addHandler("page",function(d){const y=o[d.page];P(b,`${y.surfaceType}, ${y.desc}`)})});var N=En(),S=u(N),W=u(S),Q=u(W);s(W);var ie=g(W,2),be=u(ie),V=g(be),xe=u(V,!0);s(V);var G=g(V);H(G,()=>e.objectType,f=>{var d=ln(),y=g(te(d)),D=u(y,!0);s(y),R(()=>{re(y,"href",e.objectType.ref),C(D,e.objectType._)}),k(f,d)}),s(ie);var de=g(ie,2),q=u(de),L=g(q);s(de),s(S);var $=g(S,2),me=u($),le=g(u(me),2),Me=u(le,!0);s(le),s(me);var se=g(me,2),He=u(se);tt(He,()=>l.html),s(se);var Ie=g(se,2),w=u(Ie);tt(w,()=>n.html),s(Ie);var ke=g(Ie,2);H(ke,()=>p.length,f=>{var d=sn();Ne(d,21,()=>p,We,(y,D)=>{var Y=Ge(),ne=te(Y);tt(ne,()=>a(D).html),k(y,Y)}),s(d),k(f,d)});var K=g(ke,2),De=g(u(K),2),ce=g(u(De),2),F=g(u(ce),2),X=u(F,!0);s(F);var Re=g(F,4);H(Re,()=>e.objectType,f=>{var d=cn(),y=u(d),D=u(y,!0);s(y),s(d),R(()=>{re(y,"href",e.objectType.ref),C(D,e.objectType._)}),k(f,d)},f=>{var d=un(),y=u(d,!0);s(d),R(()=>C(y,fe)),k(f,d)});var B=g(Re,4),J=u(B),Ce=u(J,!0);s(J),s(B);var ue=g(B,4);H(ue,()=>{var f;return(f=e.condition)==null?void 0:f.ana},f=>{var d=fn(),y=u(d,!0);R(()=>C(y,e.condition.ana.split(".").slice(1).join(", "))),s(d),k(f,d)},f=>{var d=vn(),y=u(d,!0);s(d),R(()=>C(y,e.condition._||fe)),k(f,d)});var Ee=g(ue,4);Ne(Ee,21,()=>e.dimensions,We,(f,d,y)=>{Tt();var D=mn(),Y=te(D),ne=g(Y);H(ne,()=>y<e.dimensions.length-1,Se=>{var je=ft(", ");k(Se,je)}),R(()=>C(Y,`${a(d).dimension??""}: ${a(d)._??""}
							${a(d).unit??""}`)),k(f,D)}),s(Ee),s(ce),s(De);var ge=g(De,2),ae=g(u(ge),2),he=g(u(ae),2),ee=u(he,!0);s(he);var Ae=g(he,4);H(Ae,()=>e.layoutDesc.layout.damage.ana,f=>{var d=gn(),y=u(d,!0);R(()=>C(y,e.layoutDesc.layout.damage.ana.split(".").slice(1).join(", "))),s(d),k(f,d)},f=>{var d=hn(),y=u(d,!0);s(d),R(()=>C(y,e.layoutDesc.layout.damage._||fe)),k(f,d)});var we=g(Ae,4),_=u(we,!0);s(we);var A=g(we,4);Ne(A,17,()=>e.handNote.dimensions.filter(f=>(f==null?void 0:f.type)==="letterHeight"),We,(f,d)=>{var y=_n(),D=u(y);s(y),R(()=>C(D,`${a(d).l??""}: ${a(d).h??""}${a(d).unit??""}`)),k(f,y)});var Pe=g(A,4);Ne(Pe,17,()=>e.handNote.dimensions.filter(f=>(f==null?void 0:f.type)==="interlinear"),We,(f,d)=>{var y=pn(),D=u(y);s(y),R(()=>C(D,`${a(d).l??""}: ${a(d).h??""}${(a(d).h!=="not measured"?a(d).unit:"")??""}`)),k(f,y)}),s(ae),s(ge),s(K);var v=g(K,2),m=g(u(v),2),M=g(u(m),2);H(M,()=>e.places.length,f=>{var d=yn(),y=u(d),D=g(y),Y=u(D,!0);s(D),s(d),R(()=>{C(y,`${(e.places[0].offset||"")??""} `),re(D,"href",e.places[0].ref),C(Y,e.places[0]._)}),k(f,d)},f=>{var d=bn(),y=u(d,!0);s(d),R(()=>C(y,fe)),k(f,d)});var U=g(M,4),_e=u(U,!0);s(U);var Je=g(U,2);H(Je,()=>{var f;return(f=e.provenanceFound)==null?void 0:f.geo},f=>{var d=kn();const y=vt(()=>[e.provenanceFound.geo[1],e.provenanceFound.geo[0]]);var D=g(te(d),2),Y=u(D);Va(Y,{get center(){return a(y)},zoom:7,class:"map",standardControls:!0,style:"https://api.maptiler.com/maps/positron/style.json?key=brTBbnRxuiKp6PgjwFPr",children:(ne,Se)=>{Ra(ne,{get lngLat(){return a(y)},children:(je,lt)=>{Ka(je,{offset:[0,-10],children:(st,Qe)=>{var Fe=xn(),Gt=u(Fe,!0);s(Fe),R(()=>C(Gt,e.provenanceFound._)),k(st,Fe)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),s(D),k(f,d)}),s(m),s(v);var Ue=g(v,2),$e=g(u(Ue),2);H($e,()=>e.provenanceLost,f=>{var d=Cn(),y=u(d,!0);s(d),R(()=>C(y,e.provenanceLost._)),k(f,d)},f=>{var d=wn(),y=g(u(d),2),D=u(y);s(y);var Y=g(y,4),ne=u(Y),Se=u(ne,!0);s(ne);var je=g(ne);H(je,()=>e.idno,Qe=>{var Fe=ft();R(()=>C(Fe,`,
							${e.idno._??""}`)),k(Qe,Fe)}),s(Y);var lt=g(Y,4),st=u(lt,!0);s(lt),Tt(4),s(d),R(()=>{var Qe;C(D,`${e.settlement??""}, ${e.country??""}`),re(ne,"href",e.repository.ref),C(Se,e.repository._),C(st,((Qe=e.provenanceObserved)==null?void 0:Qe._)||fe)}),k(f,d)}),s(Ue);var Ze=g(Ue,2),et=g(u(Ze),2);ha(et,{inscription:e});var pt=g(et,2),yt=g(u(pt),2),Zt=u(yt,!0);s(yt),s(pt),s(Ze);var nt=g(Ze,2),bt=g(u(nt),2),rt=u(bt),Ft=u(rt,!0);s(rt),s(bt),s(nt);var ot=g(nt,2),Nt=u(ot);tt(Nt,()=>I.html),s(ot);var it=g(ot,2),xt=g(u(it),2),dt=g(u(xt),2),kt=u(dt);Ne(kt,21,()=>e.editions,We,(f,d)=>{var y=On(),D=u(y);dn(D,{get edition(){return a(d)}}),s(y),k(f,y)}),s(kt),s(dt);var Wt=g(dt,2);H(Wt,()=>{var f,d;return(d=(f=e.bibliographyEdition)==null?void 0:f.bibl)==null?void 0:d.length},f=>{var d=Mn(),y=g(te(d),2),D=u(y);Ne(D,21,()=>e.bibliographyEdition.bibl,We,(Y,ne)=>{var Se=Ln(),je=u(Se);La(je,{get entry(){return a(ne)}}),s(Se),k(Y,Se)}),s(D),s(y),k(f,d)}),s(xt),s(it);var Ct=g(it,2),wt=g(u(Ct),2),Ot=g(u(wt),2),Vt=u(Ot,!0);s(Ot),s(wt),s(Ct),s($),s(N),R(()=>{var f;C(Q,`${e.file??""}: ${e.title??""}`),C(be,`${e.textLang._??""}, `),re(V,"href",e.type.ref),C(xe,e.type._),C(q,`${e.status??""}, `),re(L,"href",`${pa}inscription/${h??""}`),C(Me,a(b)),C(X,e.support||fe),re(J,"href",e.material.ref),C(Ce,e.material._),C(ee,e.layoutDesc.layout.p||fe),C(_,e.handNote.lettering||fe),C(_e,((f=e.provenanceFound)==null?void 0:f._)||fe),C(Zt,e.evidence||fe),re(rt,"href",e.type.ref),C(Ft,e.type._),C(Vt,e.citation||fe)}),k(i,N),ye()}export{Un as component};
