const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/openseadragon.CULnMEEs.js","../chunks/maplibre-gl.BlcabGBl.js","../chunks/runtime.BQotSvAO.js","../chunks/disclose-version.CNJLWmUd.js","../chunks/store.D90-691m.js","../chunks/utils.B5sIsHFd.js","../assets/maplibre-gl.CuCRB34y.css"])))=>i.map(i=>d[i]);
var Ma=Object.defineProperty;var Ea=(r,t,m)=>t in r?Ma(r,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):r[t]=m;var Wt=(r,t,m)=>Ea(r,typeof t!="symbol"?t+"":t,m);import{_ as Pa}from"../chunks/preload-helper.C1FmrZbK.js";import{d as qt,f as Sa,c as ne,a as w,b as Qe,t as M}from"../chunks/disclose-version.CNJLWmUd.js";import{B as Ta,F as Gt,P as Vt,C as Ia,G as Kt,au as Da,ay as Aa,aw as Ra,O as za,K as ja,D as Ba,z as U,q as Ce,w as c,x as i,t as R,y as f,v as ke,g as a,k as rt,aE as Na,aF as ra,aG as N,aH as We,j as b,aI as W,s as E,aJ as Ha,aK as oa,I as lt,n as Yt}from"../chunks/runtime.BQotSvAO.js";import{a as C,s as qe,f as ze,b as se,g as Fa}from"../chunks/store.D90-691m.js";import{l as Ct,s as kt,i as z,p as v,b as ia,a as st,c as Jt}from"../chunks/props.7sWcRfGm.js";import{b as $e,s as le,d as Ua,f as Za,e as Ue,B as Xt,i as Ze}from"../chunks/button.ChScB5a6.js";import{m as ye,s as Wa,t as la,I as qa}from"../chunks/maplibre-gl.BlcabGBl.js";import{c as Lt,a as et,o as sa}from"../chunks/index-client.BkwQQHTV.js";import{w as Se,r as wt,b as Ga}from"../chunks/paths.CYvLZ9pR.js";import{I as Ot,d as bt,i as Va,m as Qt,E as ge,p as Ka}from"../chunks/Icon.hc16thx9.js";import"../chunks/legacy.D7Z1dIIn.js";import{i as Ge}from"../chunks/lifecycle.BUkS9xIk.js";function nt(r,t,m,e,n){var o=r,h="",l;Ta(()=>{if(h===(h=t()??"")){Gt&&Vt();return}l!==void 0&&(Ba(l),l=void 0),h!==""&&(l=Ia(()=>{if(Gt){Kt.data;for(var s=Vt(),p=s;s!==null&&(s.nodeType!==8||s.data!=="");)p=s,s=Da(s);if(s===null)throw Aa(),Ra;qt(Kt,p),o=za(s);return}var O=h+"",k=Sa(O);qt(ja(k),k.lastChild),o.before(k)}))})}function Ya(r,t){const m=Ct(t,["children","$$slots","$$events","$$legacy"]);Ot(r,kt({name:"external-link"},()=>m,{iconNode:[["path",{d:"M15 3h6v6"}],["path",{d:"M10 14 21 3"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}]],children:(n,o)=>{var h=ne(),l=U(h);$e(l,t,"default",{},null),w(n,h)},$$slots:{default:!0}}))}function Ja(r,t){const m=Ct(t,["children","$$slots","$$events","$$legacy"]);Ot(r,kt({name:"maximize-2"},()=>m,{iconNode:[["polyline",{points:"15 3 21 3 21 9"}],["polyline",{points:"9 21 3 21 3 15"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14"}]],children:(n,o)=>{var h=ne(),l=U(h);$e(l,t,"default",{},null),w(n,h)},$$slots:{default:!0}}))}function Xa(r,t){const m=Ct(t,["children","$$slots","$$events","$$legacy"]);Ot(r,kt({name:"minimize-2"},()=>m,{iconNode:[["polyline",{points:"4 14 10 14 10 20"}],["polyline",{points:"20 10 14 10 14 4"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14"}]],children:(n,o)=>{var h=ne(),l=U(h);$e(l,t,"default",{},null),w(n,h)},$$slots:{default:!0}}))}var Qa=M("<!><!>",1),$a=M("<span> </span>"),en=M("<span> </span>"),tn=M("at <a> </a>",1),an=M("at <span> </span>",1),nn=M("<a>Zotero</a>"),rn=M("<a>FAIR</a>"),on=M("<!> <!> <!> <!>",1);function ln(r,t){Ce(t,!0);var m=on(),e=U(m);z(e,()=>t.entry.citation,l=>{var s=Qa(),p=U(s);nt(p,()=>t.entry.citation);var O=f(p);z(O,()=>t.entry.citedRange,k=>{var S=Qe(",");w(k,S)},k=>{var S=Qe(".");w(k,S)}),w(l,s)},l=>{var s=ne(),p=U(s);z(p,()=>t.entry.type==="bulletin"||t.entry.type==="corpus",O=>{var k=$a(),S=c(k);i(k),R(()=>C(S,`${t.entry.n??""} ${(t.entry.author?`${t.entry.author} (${t.entry.date})`:"")??""}`)),w(O,k)},O=>{var k=en(),S=c(k);i(k),R(()=>C(S,`${t.entry.author??""} (${t.entry.date??""})`)),w(O,k)},!0),w(l,s)});var n=f(e,2);z(n,()=>{var l;return typeof t.entry.citedRange=="object"&&((l=t.entry.citedRange)==null?void 0:l.ref)},l=>{var s=tn(),p=f(U(s)),O=c(p,!0);i(p),R(()=>{le(p,"href",t.entry.citedRange.ref.target),C(O,t.entry.citedRange.ref._)}),w(l,s)},l=>{var s=ne(),p=U(s);z(p,()=>t.entry.citedRange,O=>{var k=an(),S=f(U(k)),q=c(S,!0);i(S),R(()=>C(q,t.entry.citedRange)),w(O,k)},null,!0),w(l,s)});var o=f(n,2);z(o,()=>{var l;return(l=t.entry.ptr)==null?void 0:l.target},l=>{var s=nn();R(()=>{var p;return le(s,"href",(p=t.entry.ptr)==null?void 0:p.target)}),w(l,s)});var h=f(o,2);z(h,()=>{var l;return(l=t.entry.ref)==null?void 0:l.target},l=>{var s=rn();R(()=>le(s,"href",t.entry.ref.target)),w(l,s)}),w(r,m),ke()}var sn=M('<a target="_blank" rel="noopener noreferrer"> </a>');function dn(r,t){Ce(t,!0);function m(s){return s.padStart(6,"0")}function e(s,p){if(!p)return"";switch(s){case"DOI":return bt.DOI+p;case"EDR":case"EDH":return bt[s]+m(p);case"URI":return p;default:return bt[s]+p}}const n=rt(()=>e(t.edition.type,t.edition._)),o=rt(()=>t.edition.type==="DOI"?`DOI: ${t.edition._} (${t.edition.when})`:`${t.edition.type}: ${t.edition._}`);var h=ne(),l=U(h);z(l,()=>t.edition._,s=>{var p=sn(),O=c(p,!0);i(p),R(()=>{le(p,"href",a(n)),C(O,a(o))}),w(s,p)},s=>{var p=Qe();R(()=>C(p,`${t.edition.type??""}: -`)),w(s,p)}),w(r,h),ke()}const Mt=Symbol.for("svelte-maplibre");function tt(){return Na(Mt)}function cn(r){let t=new WeakMap;return m=>{var h;let e=t.get(m.originalEvent);if(e!==void 0)return e;let o=(h=m.target.queryRenderedFeatures(m.point).find(l=>{var s;return(s=r.get(l.layer.id))==null?void 0:s.interactive}))==null?void 0:h.layer.id;return t.set(m.originalEvent,o),o}}function un(){let r=new Map;return ra(Mt,{map:Se(null),source:wt(null),layer:wt(null),popupTarget:wt(null),cluster:Se(),loadedImages:Se(new Set),minzoom:Se(0),maxzoom:Se(24),layerEvent:Se(null),layerInfo:r,eventTopMost:cn(r),markerClickManager:new _n})}function $t(r){return{subscribe:r.subscribe}}function fn({key:r,setPopupTarget:t=!1,setCluster:m=!1,setMouseEvent:e=!1}){let n=tt(),o=Se(null),h=$t(o),l={...n,[r]:$t(o)};if(t&&(l.popupTarget=h),e){let s=Se(null);l.layerEvent=s,n.layerEvent=s}return m&&(l.cluster=Se()),ra(Mt,l),{...n,self:o}}function vn(){return fn({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function mn(r){return"layerType"in r&&r.layerType==="deckgl"}class _n{constructor(){Wt(this,"_handlers",new Set)}add(t){this._handlers.add(t)}remove(t){this._handlers.delete(t)}handleClick(t){for(const m of this._handlers)m(t)}}var da=gn;function gn(r){var t,m,e;if(r){if(Array.isArray(r)){for(t=[],m=r.length,e=0;e<m;e++){var n=r[e];n!=null&&t.push(n)}return t}if(typeof r=="object"){t={};var o=Object.keys(r);for(m=o.length,e=0;e<m;e++){var h=o[e],l=r[h];l!=null&&(t[h]=l)}return t}}}function ea(r,t){Ce(t,!1);const m=qe(),e=()=>se(Q,"$marker",m),n=()=>se(A,"$map",m);let o=v(t,"marker",12,void 0),h=v(t,"lngLat",12),l=v(t,"class",8,void 0),s=v(t,"draggable",8,!1),p=v(t,"feature",8,null),O=v(t,"offset",8,void 0),k=v(t,"rotation",8,0),S=v(t,"opacity",8,1);const q=Lt(),{map:A,layerEvent:K,self:Q}=vn(),re=()=>J("dragstart"),he=()=>{de(),J("drag")},$=()=>{de(),J("dragend")};ze(Q,new ye.Marker(da({draggable:s(),rotation:k(),className:l(),offset:O(),opacity:S().toString()})).setLngLat(h()).addTo(n())),o(e()),s()&&(e().on("dragstart",re),e().on("drag",he),e().on("dragend",$)),et(()=>{var P;o(void 0),(P=e())==null||P.remove()});function de(){var oe;let P=(oe=e())==null?void 0:oe.getLngLat();P&&(Array.isArray(h())?h([P.lng,P.lat]):h()&&"lon"in h()?h({lon:P.lng,lat:P.lat}):h(P))}function J(P){var Te,ce;let oe=(Te=e())==null?void 0:Te.getLngLat();if(!oe)return;const Le=[oe.lng,oe.lat];let ie={map:n(),marker:e(),lngLat:Le,features:[{type:"Feature",properties:((ce=p())==null?void 0:ce.properties)??{},geometry:{type:"Point",coordinates:Le}}]};ze(K,{...ie,layerType:"marker",type:P}),q(P,ie)}N(()=>(e(),b(h())),()=>{var P;(P=e())==null||P.setLngLat(h())}),N(()=>(e(),b(O())),()=>{var P;(P=e())==null||P.setOffset(O()??[0,0])}),N(()=>(e(),b(k())),()=>{var P;(P=e())==null||P.setRotation(k())}),N(()=>(e(),b(S())),()=>{var P;(P=e())==null||P.setOpacity(S().toString())}),We(),Ge();var pe=ne(),j=U(pe);$e(j,t,"default",{get marker(){return e()}},null),w(r,pe),ke()}function yn(r,t){Ce(t,!1);const m=qe(),e=()=>se(n,"$map",m),{map:n}=tt();let o=v(t,"position",8,"top-left"),h=v(t,"container",8,void 0),l=W(null);et(()=>{var s;(s=e())!=null&&s.loaded()&&a(l)&&e().removeControl(a(l))}),N(()=>(e(),a(l),b(h()),b(o())),()=>{if(e()&&!a(l)){let s;typeof h()=="string"?s=document.querySelector(h())??void 0:s=h(),E(l,new ye.FullscreenControl({container:s})),e().addControl(a(l),o())}}),We(),Ge(),ke()}function hn(r,t){Ce(t,!1);const m=qe(),e=()=>se(n,"$map",m),{map:n}=tt();let o=v(t,"position",8,"top-left"),h=v(t,"positionOptions",8,void 0),l=v(t,"fitBoundsOptions",8,void 0),s=v(t,"trackUserLocation",8,!1),p=v(t,"showAccuracyCircle",8,!0),O=v(t,"showUserLocation",8,!0),k=v(t,"control",12,null);et(()=>{var S;(S=e())!=null&&S.loaded()&&k()&&e().removeControl(k())}),N(()=>(e(),b(k()),b(h()),b(l()),b(s()),b(p()),b(O()),b(o())),()=>{e()&&!k()&&(k(new ye.GeolocateControl({positionOptions:h(),fitBoundsOptions:l(),trackUserLocation:s(),showAccuracyCircle:p(),showUserLocation:O()})),e().addControl(k(),o()))}),We(),Ge(),ke()}function pn(r){let t=r.getCenter(),m=Math.round(r.getZoom()*100)/100,e=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,e),o=Math.round(t.lat*n)/n,h=Math.round(t.lng*n)/n,l=`${m}/${o}/${h}`,s=r.getBearing(),p=r.getPitch();return(s||p)&&(l+=`/${Math.round(s*10)/10}`),p&&(l+=`/${Math.round(p)}`),`#${l}`}function xn(r){return r.replace("#","").split("/").map(parseFloat)}var Xe=Et;function Et(r,t){return r===t||r!==r&&t!==t?!0:typeof r!=typeof t||{}.toString.call(r)!={}.toString.call(t)||r!==Object(r)||!r?!1:Array.isArray(r)?ta(r,t):{}.toString.call(r)=="[object Set]"?ta(Array.from(r),Array.from(t)):{}.toString.call(r)=="[object Object]"?bn(r,t):wn(r,t)}function wn(r,t){return r.toString()===t.toString()}function ta(r,t){var m=r.length;if(m!=t.length)return!1;for(var e=0;e<m;e++)if(!Et(r[e],t[e]))return!1;return!0}function bn(r,t){var m=Object.keys(r),e=m.length;if(e!=Object.keys(t).length)return!1;for(var n=0;n<e;n++){var o=m[n];if(!(t.hasOwnProperty(o)&&Et(r[o],t[o])))return!1}return!0}function Cn(r,t){Ce(t,!1);const m=qe(),e=()=>se(n,"$map",m),{map:n}=tt();let o=v(t,"position",8,"top-left"),h=v(t,"showCompass",8,!0),l=v(t,"showZoom",8,!0),s=v(t,"visualizePitch",8,!1),p=W(null);et(()=>{var O;(O=e())!=null&&O.loaded()&&a(p)&&e().removeControl(a(p))}),N(()=>(e(),a(p),b(h()),b(l()),b(s()),b(o())),()=>{e()&&!a(p)&&(E(p,new ye.NavigationControl({showCompass:h(),showZoom:l(),visualizePitch:s()})),e().addControl(a(p),o()))}),We(),Ge(),ke()}function kn(r,t){Ce(t,!1);const m=qe(),e=()=>se(n,"$map",m),{map:n}=tt();let o=v(t,"position",8,"bottom-left"),h=v(t,"maxWidth",8,void 0),l=v(t,"unit",8,"metric"),s=W(null);et(()=>{var p;(p=e())!=null&&p.loaded()&&a(s)&&e().removeControl(a(s))}),N(()=>(e(),a(s),b(h()),b(l()),b(o())),()=>{e()&&!a(s)&&(E(s,new ye.ScaleControl({maxWidth:h(),unit:l()})),e().addControl(a(s),o()))}),We(),Ge(),ke()}var Ln=M("<!> <!> <!> <!>",1),On=M("<!> <!>",1),Mn=M('<div data-testid="map-container"><!></div>');function aa(r,t){Ce(t,!1);const m=qe(),e=()=>se(te,"$mapInstance",m),n=()=>se(ue,"$loadedImages",m),o=W(),h=W();let l=v(t,"map",12,null),s=v(t,"mapContainer",12,void 0),p=v(t,"class",8,void 0),O=v(t,"style",8),k=v(t,"diffStyleUpdates",8,!1),S=v(t,"center",12,void 0),q=v(t,"zoom",12,void 0),A=v(t,"pitch",12,0),K=v(t,"bearing",12,0),Q=v(t,"bounds",12,void 0),re=v(t,"hash",8,!1),he=v(t,"updateHash",8,_=>{window.history.replaceState(window.history.state,"",_)}),$=v(t,"loaded",12,!1),de=v(t,"minZoom",8,0),J=v(t,"maxZoom",8,22),pe=v(t,"minPitch",8,0),j=v(t,"maxPitch",8,60),P=v(t,"renderWorldCopies",8,void 0),oe=v(t,"dragPan",8,void 0),Le=v(t,"dragRotate",8,void 0),ie=v(t,"pitchWithRotate",8,void 0),Te=v(t,"antialias",8,void 0),ce=v(t,"zoomOnDoubleClick",8,!0),Ve=v(t,"locale",8,void 0),je=v(t,"interactive",8,!0),L=v(t,"attributionControl",8,!0),Ie=v(t,"cooperativeGestures",8,!1),ee=v(t,"preserveDrawingBuffer",8,!1),Be=v(t,"maxBounds",8,void 0),xe=v(t,"images",24,()=>[]),G=v(t,"standardControls",8,!1),Y=v(t,"filterLayers",8,void 0),Ke=v(t,"transformRequest",8,void 0);const F=Lt(),{map:te,loadedImages:ue}=un();let fe=W(new Set);async function Ne(_,y=!1){var T;if(e()&&!(!e().loaded()&&!y))if("url"in _){a(fe).add(_.id);try{let Z=await e().loadImage(_.url);(T=e())==null||T.addImage(_.id,Z.data,_.options),n().add(_.id),ze(ue,n())}catch(Z){F("error",Z)}finally{a(fe).delete(_.id)}}else e().addImage(_.id,_.data,_.options),n().add(_.id),ze(ue,n())}let ve=W(void 0),me=W(void 0),Oe=W(void 0),X=W(void 0);function De(_){return x(),ze(te,new ye.Map(da({container:_,style:O(),locale:Ve(),center:S(),zoom:q(),pitch:A(),bearing:K(),minZoom:de(),maxZoom:J(),minPitch:pe(),maxPitch:j(),renderWorldCopies:P(),dragPan:oe(),dragRotate:Le(),pitchWithRotate:ie(),antialias:Te(),interactive:je(),preserveDrawingBuffer:ee(),maxBounds:Be(),bounds:Q(),attributionControl:L(),transformRequest:Ke(),cooperativeGestures:Ie()}))),e().on("load",y=>{y.target.getContainer().setAttribute("data-testid","map"),y.target.getCanvas().setAttribute("data-testid","map-canvas"),$(!0),F("load",e())}),e().on("error",y=>F("error",{...y,map:e()})),e().on("movestart",y=>F("movestart",{...y,map:e()})),e().on("moveend",y=>{if(S(y.target.getCenter()),q(y.target.getZoom()),A(y.target.getPitch()),K(y.target.getBearing()),Q(y.target.getBounds()),F("moveend",{...y,map:e()}),re()){let T=new URL(window.location.href.replace(/(#.+)?$/,pn(e())));he()(T)}}),e().on("click",y=>F("click",{...y,map:e()})),e().on("dblclick",y=>F("dblclick",{...y,map:e()})),e().on("contextmenu",y=>F("contextmenu",{...y,map:e()})),e().on("zoomstart",y=>F("zoomstart",{...y,map:e()})),e().on("zoom",y=>{F("zoom",{...y,map:e()})}),e().on("zoomend",y=>{F("zoomend",{...y,map:e()})}),e().on("style.load",()=>{if(e()){const y=e().getStyle();if(E(ve,y.layers.map(T=>T.id)),E(me,Object.keys(y.sources)),a(X))for(const[T,Z]of Object.entries(a(X)))e().addSource(T,Z);if(a(Oe))for(const T of a(Oe))e().addLayer(T);for(const T of xe())Ne(T,!0)}}),e().on("styledata",y=>{if(e()&&Y()){const T=e().getStyle().layers;if(T)for(let Z of T)Y()(Z)||e().setLayoutProperty(Z.id,"visibility","none")}F("styledata",{...y,map:e()})}),{destroy(){var y;$(!1),(y=e())==null||y.remove(),ze(te,null)}}}let Me=W(O());function x(){if(re()){let _=xn(window.location.hash);_.length>=3&&(q(_[0]),S([_[2],_[1]])),_.length==5&&(K(_[3]),A(_[4]))}}N(()=>b(G()),()=>{E(o,typeof G()=="boolean"?void 0:G())}),N(()=>e(),()=>{l(e())}),N(()=>(e(),b(O()),a(Me),a(ve),a(me),b(k())),()=>{if(e()&&!Xe(O(),a(Me))){const _=e().getStyle();if(a(ve)&&E(Oe,_.layers.filter(y=>!a(ve).includes(y.id))),a(me)){const y=Object.keys(_.sources).filter(T=>!a(me).includes(T));E(X,{});for(const T of y)oa(X,a(X)[T]=_.sources[T])}E(Me,O()),e().setStyle(O(),{diff:k()}),ze(ue,new Set),E(fe,new Set)}}),N(()=>(b($()),e(),b(xe()),n(),a(fe)),()=>{var _;if($()&&((_=e())!=null&&_.loaded()))for(let y of xe())!n().has(y.id)&&!a(fe).has(y.id)&&!e().hasImage(y.id)&&Ne(y)}),N(()=>(b(xe()),n()),()=>{E(h,xe().every(_=>n().has(_.id)))}),N(()=>(e(),b(S()),b(q()),b(K()),b(A())),()=>{var _,y,T,Z;if(e()){let _e={};S()!=null&&!Xe(S(),(_=e())==null?void 0:_.getCenter())&&(_e.center=S()),q()!=null&&!Xe(q(),(y=e())==null?void 0:y.getZoom())&&(_e.zoom=q()),K()!=null&&!Xe(K(),(T=e())==null?void 0:T.getBearing())&&(_e.bearing=K()),A()!=null&&!Xe(A(),(Z=e())==null?void 0:Z.getPitch())&&(_e.pitch=A()),Object.keys(_e).length&&e().easeTo(_e)}}),N(()=>(b(Q()),e()),()=>{var _,y;Q()&&!Xe(Q(),(_=e())==null?void 0:_.getBounds())&&((y=e())==null||y.fitBounds(Q()))}),N(()=>(b(ce()),e()),()=>{var _,y;ce()?(_=e())==null||_.doubleClickZoom.enable():(y=e())==null||y.doubleClickZoom.disable()}),We(),Ge();var B=Mn();Fa("hashchange",Ha,x);var we=c(B);z(we,()=>e()&&$(),_=>{var y=On(),T=U(y);z(T,G,_e=>{var Ye=Ln(),it=U(Ye);Cn(it,{get position(){return a(o)}});var at=f(it,2);hn(at,{get position(){return a(o)},fitBoundsOptions:{maxZoom:12}});var Je=f(at,2);yn(Je,{get position(){return a(o)}});var ct=f(Je,2);kn(ct,{get position(){return a(o)}}),w(_e,Ye)});var Z=f(T,2);$e(Z,t,"default",{get map(){return e()},get loadedImages(){return n()},get allImagesLoaded(){return a(h)}},null),w(_,y)}),i(B),ia(B,_=>s(_),()=>s()),Ua(B,_=>De(_)),R(()=>{Wa(B,`${p()??""} svelte-p00lfq`),la(B,"expand-map",!p())}),w(r,B),ke()}var En=M("<div><!></div>");function na(r,t){const m=Za(t);Ce(t,!1);const e=qe(),n=()=>se(Le,"$popupTarget",e),o=()=>se(oe,"$map",e),h=()=>se(Te,"$layer",e),l=()=>se(ie,"$layerEvent",e),s=W(),p=W();let O=v(t,"closeButton",8,void 0),k=v(t,"closeOnClickOutside",8,!0),S=v(t,"closeOnClickInside",8,!1),q=v(t,"closeOnMove",8,!1),A=v(t,"openOn",8,"click"),K=v(t,"openIfTopMost",8,!0),Q=v(t,"focusAfterOpen",8,!0),re=v(t,"anchor",8,void 0),he=v(t,"offset",8,void 0),$=v(t,"popupClass",8,void 0),de=v(t,"maxWidth",8,void 0),J=v(t,"lngLat",12,void 0),pe=v(t,"html",8,void 0),j=v(t,"open",12,!1);const P=Lt(),{map:oe,popupTarget:Le,layerEvent:ie,layer:Te,eventTopMost:ce,markerClickManager:Ve}=tt(),je=["click","dblclick","contextmenu"];let L=W(),Ie=W(!1),ee=W();function Be(){if(!a(L))return;let x=a(L).getElement();!x||x===a(ee)||(E(ee,x),A()==="hover"&&oa(ee,a(ee).style.pointerEvents="none"),a(ee).addEventListener("mouseenter",()=>{E(Ie,!0)},{passive:!0}),a(ee).addEventListener("mouseleave",()=>{E(Ie,!1)},{passive:!0}),a(ee).addEventListener("click",()=>{S()&&j(!1)},{passive:!0}))}sa(()=>{if(o())return o().on("click",me),o().on("contextmenu",me),Ve.add(Oe),typeof n()=="string"&&(o().on("click",n(),F),o().on("dblclick",n(),F),o().on("contextmenu",n(),F),o().on("mousemove",n(),ve),o().on("mouseleave",n(),Ne),o().on("touchstart",n(),ue),o().on("touchend",n(),fe)),()=>{var x,B;(x=o())!=null&&x.loaded()&&((B=a(L))==null||B.remove(),o().off("click",me),o().off("contextmenu",me),Ve.remove(Oe),n()instanceof ye.Marker?n().getPopup()===a(L)&&n().setPopup(void 0):typeof n()=="string"&&(o().off("click",n(),F),o().off("dblclick",n(),F),o().off("contextmenu",n(),F),o().off("mousemove",n(),ve),o().off("mouseleave",n(),Ne),o().off("touchstart",n(),ue),o().off("touchend",n(),fe)))}});function xe(x){return K()?!("marker"in x)&&!mn(x)&&ce(x)!==h():!1}let G=W(null),Y=W("normal");function Ke(x){"layerType"in x&&x.layerType==="deckgl"?(J(x.coordinate),E(G,x.object?[x.object]:null)):(J(x.lngLat),E(G,x.features??[]))}function F(x){x.type!==A()||xe(x)||(Ke(x),setTimeout(()=>j(!0)))}let te=null;function ue(x){te=x.point}function fe(x){if(!te||A()!=="hover")return;let B=te.dist(x.point);te=null,B<3&&(J(x.lngLat),E(G,x.features??[]),a(L).isOpen()?E(Y,"justOpened"):(E(Y,"opening"),j(!0)))}function Ne(x){A()!=="hover"||te||a(Y)!=="normal"||(j(!1),E(G,null))}function ve(x){if(!(A()!=="hover"||te||a(Y)!=="normal")){if(xe(x)){j(!1),E(G,null);return}j(!0),E(G,x.features??[]),J(x.lngLat)}}function me(x){var we;if(a(Y)==="justOpened"){E(Y,"normal");return}if(!k())return;let B=[a(ee),n()instanceof ye.Marker?(we=n())==null?void 0:we.getElement():null];j()&&a(L).isOpen()&&!B.some(_=>_==null?void 0:_.contains(x.originalEvent.target))&&(x.type==="contextmenu"&&A()==="contextmenu"||x.type!=="contextmenu")&&j(!1)}function Oe(x){k()&&j()&&a(L).isOpen()&&x.marker!==n()&&j(!1)}et(()=>{var x;o()&&((x=a(L))!=null&&x.isOpen())&&a(L).remove()});let X=W();N(()=>(b(O()),b(k()),b(S())),()=>{E(s,O()??(!k()&&!S()))}),N(()=>(a(L),a(s),b(q()),b(Q()),b(de()),b($()),b(re()),b(he())),()=>{a(L)||(E(L,new ye.Popup({closeButton:a(s),closeOnClick:!1,closeOnMove:q(),focusAfterOpen:Q(),maxWidth:de(),className:$(),anchor:re(),offset:he()})),E(ee,a(L).getElement()),a(L).on("open",()=>{j(!0),Be(),P("open",a(L))}),a(L).on("close",()=>{j(!1),P("close",a(L))}),a(L).on("hover",()=>{P("hover",a(L))}))}),N(()=>(a(L),n(),b(A())),()=>{a(L)&&n()instanceof ye.Marker&&(A()==="click"?n().setPopup(a(L)):n().getPopup()===a(L)&&n().setPopup(void 0))}),N(()=>(b(A()),l()),()=>{var x;je.includes(A())&&((x=l())==null?void 0:x.type)===A()&&(F(l()),ze(ie,null))}),N(()=>(b(A()),l()),()=>{var x,B;E(p,A()==="hover"&&(((x=l())==null?void 0:x.type)==="mousemove"||((B=l())==null?void 0:B.type)==="mouseenter"))}),N(()=>(b(A()),a(p),l(),a(Ie)),()=>{A()==="hover"&&ie&&(a(p)&&l()&&Ke(l()),j((a(p)||a(Ie))??!1))}),N(()=>(a(X),a(L),b(pe())),()=>{a(X)?a(L).setDOMContent(a(X)):pe()&&a(L).setHTML(pe())}),N(()=>(b(J()),a(L)),()=>{J()&&a(L).setLngLat(J())}),N(()=>(o(),a(L),b(j()),a(Y)),()=>{if(o()){let x=a(L).isOpen();j()&&!x?(a(L).addTo(o()),a(Y)==="opening"&&E(Y,"justOpened")):!j()&&x&&a(L).remove()}}),We(),Ge();var De=ne(),Me=U(De);z(Me,()=>m.default,x=>{var B=En(),we=c(B);z(we,()=>{var _;return((_=a(G))==null?void 0:_.length)||n()instanceof ye.Marker},_=>{var y=ne(),T=U(y);$e(T,t,"default",{get features(){return a(G)},get data(){var Z;return((Z=a(G))==null?void 0:Z[0])??null},get map(){return o()},close:()=>j(!1)},null),w(_,y)}),i(B),ia(B,_=>E(X,_),()=>a(X)),w(x,B)}),w(r,De),ke()}var ot=Uint8Array,ca=Uint16Array,Pn=Int32Array,Sn=new ot([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tn=new ot([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ua=function(r,t){for(var m=new ca(31),e=0;e<31;++e)m[e]=t+=1<<r[e-1];for(var n=new Pn(m[30]),e=1;e<30;++e)for(var o=m[e];o<m[e+1];++o)n[o]=o-m[e]<<5|e;return{b:m,r:n}},fa=ua(Sn,2),In=fa.b,Dn=fa.r;In[28]=258,Dn[258]=28;ua(Tn,0);var An=new ca(32768);for(D=0;D<32768;++D)Pe=(D&43690)>>1|(D&21845)<<1,Pe=(Pe&52428)>>2|(Pe&13107)<<2,Pe=(Pe&61680)>>4|(Pe&3855)<<4,An[D]=((Pe&65280)>>8|(Pe&255)<<8)>>1;var Pe,D,dt=new ot(288);for(D=0;D<144;++D)dt[D]=8;var D;for(D=144;D<256;++D)dt[D]=9;var D;for(D=256;D<280;++D)dt[D]=7;var D;for(D=280;D<288;++D)dt[D]=8;var D,Rn=new ot(32);for(D=0;D<32;++D)Rn[D]=5;var D,zn=new ot(0),jn=typeof TextDecoder<"u"&&new TextDecoder,Bn=0;try{jn.decode(zn,{stream:!0}),Bn=1}catch{}var Nn=M('<dd class="svelte-1iw5xuy"><a class="svelte-1iw5xuy"> </a></dd>'),Hn=M('<section id="translations" class="svelte-1iw5xuy"></section>'),Fn=M("<dd><a> </a></dd>"),Un=M("<dd> </dd>"),Zn=M("<dd> </dd>"),Wn=M("<dd> </dd>"),qn=M(" <!>",1),Gn=M("<dd> </dd>"),Vn=M("<dd> </dd>"),Kn=M("<dd> </dd>"),Yn=M("<dd> </dd>"),Jn=M("<dd> <a> </a></dd>"),Xn=M("<dd> </dd>"),Qn=M('<div class="popup"> </div>'),$n=M("<dt>Map</dt> <dd><!></dd>",1),er=M("<p> </p>"),tr=M('<div class="popup"> </div>'),ar=M("<dt>Map</dt> <dd><!></dd>",1),nr=M("<dl><dt>Place</dt> <dd> </dd> <dt>Repository</dt> <dd><a> </a><!></dd> <dt>Autopsy</dt> <dd> </dd> <!></dl>"),rr=M("<li><!></li>"),or=M("<li><!></li>"),ir=M('<dt>Printed editions</dt> <dd><ul class="bibliography-list"></ul></dd>',1),lr=M('<article class="svelte-1iw5xuy"><section id="overview" class="svelte-1iw5xuy"><div class="overview-header svelte-1iw5xuy"><h1 class="inscription-title svelte-1iw5xuy"> </h1> <!></div> <figure id="facsimile-images" class="svelte-1iw5xuy"><section id="image-viewer" style="height: 50vh; width: 100%;"></section> <figcaption class="svelte-1iw5xuy"> </figcaption></figure> <dl class="svelte-1iw5xuy"><dt class="svelte-1iw5xuy">ID</dt> <dd class="svelte-1iw5xuy"> </dd> <dt class="svelte-1iw5xuy">Language</dt> <dd class="svelte-1iw5xuy"> </dd> <dt class="svelte-1iw5xuy">Text type</dt> <dd class="svelte-1iw5xuy"><a class="svelte-1iw5xuy"> </a></dd> <dt class="svelte-1iw5xuy">Object type</dt> <!> <dt class="svelte-1iw5xuy">Status</dt> <dd class="svelte-1iw5xuy"> </dd> <dt class="svelte-1iw5xuy">Links</dt> <dd class="svelte-1iw5xuy"><a target="inscription" class="svelte-1iw5xuy">View in current site <!></a></dd></dl></section> <section id="content" class="svelte-1iw5xuy"><section id="edition" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Edition</h2> <div class="tabs svelte-1iw5xuy"></div> <div class="edition-content"><!></div></section> <section id="apparatus" class="svelte-1iw5xuy"><!></section> <!> <section id="physical-description" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Physical description</h2> <h3 class="svelte-1iw5xuy">Support</h3> <dl><dt>Description</dt> <dd> </dd> <dt>Object type</dt> <!> <dt>Material</dt> <dd><a> </a></dd> <dt>Condition</dt> <!> <dt>Dimensions</dt> <dd></dd></dl> <h3 class="svelte-1iw5xuy">Inscription</h3> <dl><dt>Layout</dt> <dd> </dd> <dt>Text condition</dt> <!> <dt>Lettering</dt> <dd> </dd> <dt>Letter heights</dt> <!> <dt>Interlinear heights</dt> <!></dl></section> <section id="provenance" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Provenance</h2> <dl><dt>Place of origin</dt> <!> <dt>Provenance found</dt> <dd> </dd> <!></dl></section> <section id="current-location" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Current location</h2> <!></section> <section id="date" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Date</h2> <!>) <dl><dt>Evidence</dt> <dd> </dd></dl></section> <section id="text-type" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Text type</h2> <p><a> </a></p></section> <section id="commentary" class="svelte-1iw5xuy"><!></section> <section id="bibliography" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Bibliography</h2> <dl><dt>Digital editions</dt> <dd><ul></ul></dd> <!></dl></section> <section id="citation-and-status" class="svelte-1iw5xuy"><h2 class="svelte-1iw5xuy">Citation and editorial status</h2> <dl><dt>Citation</dt> <dd> </dd></dl></section></section></article>');function kr(r,t){Ce(t,!0);let{slug:m,metadata:e,images:n,html:o}=t.data,h=lt(st(n[0].desc));const l=o.divs.find(u=>u.id==="editions");let s=lt(st([]));const p=o.divs.find(u=>u.id==="apparatus"),O=o.divs.filter(u=>u.id==="translation"),k=o.divs.find(u=>u.id==="commentary");let S=n.map(u=>`${Va}${m}/${u.url}/info.json`),q,A=lt(!1),K=lt(0);sa(async()=>{q=(await Pa(async()=>{const{default:d}=await import("../chunks/openseadragon.CULnMEEs.js").then(g=>g.o);return{default:d}},__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)).default,q({id:"image-viewer",prefixUrl:`${Ga}/openseadragon/images/`,tileSources:S,sequenceMode:!0,showReferenceStrip:!0,preserveViewport:!0}).addHandler("page",function(d){const g=n[d.page];E(h,`${g.surfaceType}, ${g.desc}`)}),l&&(E(s,st(Q(l.html))),E(K,0))});function Q(u){if(typeof window>"u")return[];const g=new DOMParser().parseFromString(u,"text/html");return Array.from(g.querySelectorAll('[id^="edition-"]')).map(H=>({id:H.id,type:H.id.replace("edition-",""),html:H.outerHTML}))}var re=lr(),he=c(re),$=c(he),de=c($),J=c(de);i(de);var pe=f(de,2);Jt(pe,()=>Xt,(u,d)=>{d(u,{class:"expand-button surface-1",onclick:()=>E(A,!a(A)),children:(g,I)=>{var H=ne(),V=U(H);z(V,()=>a(A),ae=>{Xa(ae,{})},ae=>{Ja(ae,{})}),w(g,H)},$$slots:{default:!0}})}),i($);var j=f($,2),P=f(c(j),2),oe=c(P,!0);i(P),i(j);var Le=f(j,2),ie=f(c(Le),2),Te=c(ie,!0);i(ie);var ce=f(ie,4),Ve=c(ce,!0);i(ce);var je=f(ce,4),L=c(je),Ie=c(L,!0);i(L),i(je);var ee=f(je,4);z(ee,()=>e.objectType,u=>{var d=Nn(),g=c(d),I=c(g,!0);i(g),i(d),R(()=>{le(g,"href",e.objectType.ref),C(I,e.objectType._)}),w(u,d)});var Be=f(ee,4),xe=c(Be,!0);i(Be);var G=f(Be,4),Y=c(G),Ke=f(c(Y));Ya(Ke,{}),i(Y),i(G),i(Le),i(he);var F=f(he,2),te=c(F),ue=f(c(te),2);Ue(ue,21,()=>a(s),Ze,(u,d,g)=>{var I=ne(),H=U(I),V=rt(()=>a(K)===g?"active":"");Jt(H,()=>Xt,(ae,Ee)=>{Ee(ae,{get class(){return a(V)},onclick:()=>E(K,st(g)),children:(Ae,Re)=>{Yt();var He=Qe();R(()=>C(He,a(d).type)),w(Ae,He)},$$slots:{default:!0}})}),w(u,I)}),i(ue);var fe=f(ue,2),Ne=c(fe);nt(Ne,()=>{var u;return((u=a(s)[a(K)])==null?void 0:u.html)||""}),i(fe),i(te);var ve=f(te,2),me=c(ve);nt(me,()=>p.html),i(ve);var Oe=f(ve,2);z(Oe,()=>O.length,u=>{var d=Hn();Ue(d,21,()=>O,Ze,(g,I)=>{var H=ne(),V=U(H);nt(V,()=>a(I).html),w(g,H)}),i(d),w(u,d)});var X=f(Oe,2),De=f(c(X),4),Me=f(c(De),2),x=c(Me,!0);i(Me);var B=f(Me,4);z(B,()=>e.objectType,u=>{var d=Fn(),g=c(d),I=c(g,!0);i(g),i(d),R(()=>{le(g,"href",e.objectType.ref),C(I,e.objectType._)}),w(u,d)},u=>{var d=Un(),g=c(d,!0);i(d),R(()=>C(g,ge)),w(u,d)});var we=f(B,4),_=c(we),y=c(_,!0);i(_),i(we);var T=f(we,4);z(T,()=>{var u;return(u=e.condition)==null?void 0:u.ana},u=>{var d=Zn(),g=c(d,!0);R(()=>C(g,e.condition.ana.split(".").slice(1).join(", "))),i(d),w(u,d)},u=>{var d=Wn(),g=c(d,!0);i(d),R(()=>C(g,e.condition._||ge)),w(u,d)});var Z=f(T,4);Ue(Z,21,()=>e.dimensions,Ze,(u,d,g)=>{Yt();var I=qn(),H=U(I),V=f(H);z(V,()=>g<e.dimensions.length-1,ae=>{var Ee=Qe(", ");w(ae,Ee)}),R(()=>C(H,`${a(d).dimension??""}: ${a(d)._??""}
						${a(d).unit??""}`)),w(u,I)}),i(Z),i(De);var _e=f(De,4),Ye=f(c(_e),2),it=c(Ye,!0);i(Ye);var at=f(Ye,4);z(at,()=>e.layoutDesc.layout.damage.ana,u=>{var d=Gn(),g=c(d,!0);R(()=>C(g,e.layoutDesc.layout.damage.ana.split(".").slice(1).join(", "))),i(d),w(u,d)},u=>{var d=Vn(),g=c(d,!0);i(d),R(()=>C(g,e.layoutDesc.layout.damage._||ge)),w(u,d)});var Je=f(at,4),ct=c(Je,!0);i(Je);var Pt=f(Je,4);Ue(Pt,17,()=>e.handNote.dimensions.filter(u=>(u==null?void 0:u.type)==="letterHeight"),Ze,(u,d)=>{var g=Kn(),I=c(g);i(g),R(()=>C(I,`${a(d).l??""}: ${a(d).h??""}${a(d).unit??""}`)),w(u,g)});var va=f(Pt,4);Ue(va,17,()=>e.handNote.dimensions.filter(u=>(u==null?void 0:u.type)==="interlinear"),Ze,(u,d)=>{var g=Yn(),I=c(g);i(g),R(()=>C(I,`${a(d).l??""}: ${a(d).h??""}${(a(d).h!=="not measured"?a(d).unit:"")??""}`)),w(u,g)}),i(_e),i(X);var ut=f(X,2),St=f(c(ut),2),Tt=f(c(St),2);z(Tt,()=>e.places.length,u=>{var d=Jn(),g=c(d),I=f(g),H=c(I,!0);i(I),i(d),R(()=>{C(g,`${(e.places[0].offset||"")??""} `),le(I,"href",e.places[0].ref),C(H,e.places[0]._)}),w(u,d)},u=>{var d=Xn(),g=c(d,!0);i(d),R(()=>C(g,ge)),w(u,d)});var ft=f(Tt,4),ma=c(ft,!0);i(ft);var _a=f(ft,2);z(_a,()=>{var u;return(u=e.provenanceFound)==null?void 0:u.geo},u=>{var d=$n();const g=rt(()=>[e.provenanceFound.geo[1],e.provenanceFound.geo[0]]);var I=f(U(d),2),H=c(I);aa(H,{get center(){return a(g)},zoom:7,class:"map",standardControls:!0,get style(){return Qt},children:(V,ae)=>{ea(V,{get lngLat(){return a(g)},children:(Ee,Ae)=>{na(Ee,{offset:[0,-10],children:(Re,He)=>{var be=Qn(),Fe=c(be,!0);i(be),R(()=>C(Fe,e.provenanceFound._)),w(Re,be)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),i(I),w(u,d)}),i(St),i(ut);var vt=f(ut,2),ga=f(c(vt),2);z(ga,()=>e.provenanceLost,u=>{var d=er(),g=c(d,!0);i(d),R(()=>C(g,e.provenanceLost._)),w(u,d)},u=>{var d=nr(),g=f(c(d),2),I=c(g);i(g);var H=f(g,4),V=c(H),ae=c(V,!0);i(V);var Ee=f(V);z(Ee,()=>e.idno,be=>{var Fe=Qe();R(()=>C(Fe,`,
							${e.idno._??""}`)),w(be,Fe)}),i(H);var Ae=f(H,4),Re=c(Ae,!0);i(Ae);var He=f(Ae,2);z(He,()=>e.repository.museum.location.geo,be=>{var Fe=ar();const Ut=rt(()=>[e.repository.museum.location.geo.lon,e.repository.museum.location.geo.lat]);var Zt=f(U(Fe),2),ba=c(Zt);aa(ba,{get center(){return a(Ut)},zoom:7,class:"map",standardControls:!0,get style(){return Qt},children:(Ca,sr)=>{ea(Ca,{get lngLat(){return a(Ut)},children:(ka,dr)=>{na(ka,{offset:[0,-10],children:(La,cr)=>{var xt=tr(),Oa=c(xt,!0);i(xt),R(()=>C(Oa,e.repository.museum.name)),w(La,xt)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),i(Zt),w(be,Fe)}),i(d),R(()=>{var be;C(I,`${e.settlement??""}, ${e.country??""}`),le(V,"href",e.repository.ref),C(ae,e.repository._),C(Re,((be=e.provenanceObserved)==null?void 0:be._)||ge)}),w(u,d)}),i(vt);var mt=f(vt,2),It=f(c(mt)),Dt=f(It);qa(Dt,{get date(){return e.date}});var At=f(Dt,2),Rt=f(c(At),2),ya=c(Rt,!0);i(Rt),i(At),i(mt);var _t=f(mt,2),zt=f(c(_t),2),gt=c(zt),ha=c(gt,!0);i(gt),i(zt),i(_t);var yt=f(_t,2),pa=c(yt);nt(pa,()=>k.html),i(yt);var ht=f(yt,2),jt=f(c(ht),2),pt=f(c(jt),2),Bt=c(pt);Ue(Bt,21,()=>e.editions,Ze,(u,d)=>{var g=rr(),I=c(g);dn(I,{get edition(){return a(d)}}),i(g),w(u,g)}),i(Bt),i(pt);var xa=f(pt,2);z(xa,()=>{var u,d;return(d=(u=e.bibliographyEdition)==null?void 0:u.bibl)==null?void 0:d.length},u=>{var d=ir(),g=f(U(d),2),I=c(g);Ue(I,21,()=>e.bibliographyEdition.bibl,Ze,(H,V)=>{var ae=ne(),Ee=U(ae);z(Ee,()=>a(V),Ae=>{var Re=or(),He=c(Re);ln(He,{get entry(){return a(V)}}),i(Re),w(Ae,Re)}),w(H,ae)}),i(I),i(g),w(u,d)}),i(jt),i(ht);var Nt=f(ht,2),Ht=f(c(Nt),2),Ft=f(c(Ht),2),wa=c(Ft,!0);i(Ft),i(Ht),i(Nt),i(F),i(re),R(()=>{var u;la(re,"expanded",a(A)),C(J,`${e.file??""}: ${e.title??""}`),C(oe,a(h)),C(Te,e.file),C(Ve,e.textLang._),le(L,"href",e.type.ref),C(Ie,e.type._),C(xe,e.status),le(Y,"href",`${Ka}inscription/${m??""}`),C(x,e.support||ge),le(_,"href",e.material.ref),C(y,e.material._),C(it,e.layoutDesc.layout.p||ge),C(ct,e.handNote.lettering||ge),C(ma,((u=e.provenanceFound)==null?void 0:u._)||ge),C(It,` ${e.date._??""} (`),C(ya,e.date.evidence||ge),le(gt,"href",e.type.ref),C(ha,e.type._),C(wa,e.citation||ge)}),w(r,re),ke()}export{kr as component};
